var appEnv={env:"development",api:"http://stg.coral.io:8081/v1"};angular.module("debounce",[]).directive("ngDebounce",["$timeout",function(t){return{restrict:"A",require:"ngModel",priority:99,link:function(e,n,r,i){if("radio"!==r.type&&"checkbox"!==r.type){var o={timeout:1e3},a=e.$eval(r.ngDebounce)||$.extend({},o);n.unbind("input");var s;n.bind("input",function(){t.cancel(s),s=t(function(){e.$apply(function(){i.$setViewValue(n.val())})},a.timeout)}),n.bind("blur",function(){e.$apply(function(){i.$setViewValue(n.val())})})}}}}]),function(t,e){"$:nomunge";var n,r=t.jQuery||t.Cowboy||(t.Cowboy={});r.throttle=n=function(t,n,i,o){function a(){function r(){l=+new Date,i.apply(u,h)}function a(){s=e}var u=this,c=+new Date-l,h=arguments;o&&!s&&r(),s&&clearTimeout(s),o===e&&c>t?r():n!==!0&&(s=setTimeout(o?a:r,o===e?t-c:t))}var s,l=0;return"boolean"!=typeof n&&(o=i,i=n,n=e),r.guid&&(a.guid=i.guid=i.guid||r.guid++),a},r.debounce=function(t,r,i){return i===e?n(t,r,!1):n(t,i,r!==!1)}}(this),angular.module("directive.ng-extend",[]).directive("ngExEnter",function(){return function(t,e,n){e.bind("keydown keypress",function(e){13===e.which&&(t.$apply(function(){t.$eval(n.ngExEnter,{event:e})}),e.preventDefault())})}}).directive("ngExKeyTab",function(){return function(t,e,n){e.bind("keydown keypress",function(e){9===e.which&&t.$apply(function(){t.$eval(n.ngExKeyTab,{event:e})})})}}).directive("ngExKeyEsc",function(){return function(t,e,n){e.bind("keydown keypress",function(e){27===e.which&&t.$apply(function(){t.$eval(n.ngExKeyEsc,{event:e})})})}}).directive("ngExOnresize",["$window","$parse",function(t,e){return{restrict:"A",link:function(n,r,i){var o=function(t,n,r){function i(n){var r=-1!==n.indexOf("(")?n.indexOf("("):n.length,i=-1!==n.lastIndexOf(")")?n.lastIndexOf(")"):n.length,o=n.substring(r+1,i),a=n.match(/^[^.]+.\s*/)[0].slice(0,-1);return a=t[a]&&"function"==typeof t[a].constructor?a:null,{callback:n.substring(a&&a.length+1||0,r),args:(o&&o.split(",")||[]).map(function(n){return e(n)(t)}),constructor:a}}if(n){var o=i(n),a=o.callback,s=o.constructor,l=[r].concat(o.args);t.$apply((t[a]||t[s][a]).apply(t,l))}},a=function(){o(n,i.ngExOnresize,{windowHeight:t.innerHeight,windowWidth:t.innerWidth,height:r.height(),width:r.width()})};return angular.element(t).bind("resize",function(){return a(),n.$apply()})}}}]).directive("ngExDraggable",["$parse",function(t){return{restrict:"A",link:function(e,n,r){var i=e.$eval(r.ngExDraggableOptions),o=function(e,n,r,i){function o(n){var r=-1!==n.indexOf("(")?n.indexOf("("):n.length,i=-1!==n.lastIndexOf(")")?n.lastIndexOf(")"):n.length,o=n.substring(r+1,i),a=n.match(/^[^.]+.\s*/)[0].slice(0,-1);return a=e[a]&&"function"==typeof e[a].constructor?a:null,{callback:n.substring(a&&a.length+1||0,r),args:(o&&o.split(",")||[]).map(function(n){return t(n)(e)}),constructor:a}}if(n){var a=o(n),s=a.callback,l=a.constructor,u=[r,i].concat(a.args);e.$apply((e[s]||e[l][s]).apply(e,u))}};i.create=function(t,n){o(e,r.ngExDraggableCreate,t,n)},i.drag=function(t,n){o(e,r.ngExDraggableDrag,t,n)},i.start=function(t,n){o(e,r.ngExDraggableStart,t,n)},i.stop=function(t,n){o(e,r.ngExDraggableStop,t,n)},$(n).draggable(i)}}}]).directive("ngExDroppable",["$parse",function(t){return{restrict:"A",link:function(e,n,r){var i=e.$eval(r.ngExDroppableOptions),o=function(e,n,r,i){function o(n){var r=-1!==n.indexOf("(")?n.indexOf("("):n.length,i=-1!==n.lastIndexOf(")")?n.lastIndexOf(")"):n.length,o=n.substring(r+1,i),a=n.match(/^[^.]+.\s*/)[0].slice(0,-1);return a=e[a]&&"function"==typeof e[a].constructor?a:null,{callback:n.substring(a&&a.length+1||0,r),args:(o&&o.split(",")||[]).map(function(n){return t(n)(e)}),constructor:a}}if(n){var a=o(n),s=a.callback,l=a.constructor,u=[r,i].concat(a.args);e.$apply((e[s]||e[l][s]).apply(e,u))}};i.activate=function(t,n){o(e,r.ngExDroppableActivate,t,n)},i.create=function(t,n){o(e,r.ngExDroppableCreate,t,n)},i.deactivate=function(t,n){o(e,r.ngExDroppableDeactivate,t,n)},i.drop=function(t,n){o(e,r.ngExDroppableDrop,t,n)},i.out=function(t,n){o(e,r.ngExDroppableOut,t,n)},i.over=function(t,n){o(e,r.ngExDroppableOver,t,n)},$(n).droppable(i)}}}]).directive("ngExResizable",["$parse",function(t){return{restrict:"A",link:function(e,n,r){var i=e.$eval(r.ngExResizableOptions),o=function(e,n,r,i){function o(n){var r=-1!==n.indexOf("(")?n.indexOf("("):n.length,i=-1!==n.lastIndexOf(")")?n.lastIndexOf(")"):n.length,o=n.substring(r+1,i),a=n.match(/^[^.]+.\s*/)[0].slice(0,-1);return a=e[a]&&"function"==typeof e[a].constructor?a:null,{callback:n.substring(a&&a.length+1||0,r),args:(o&&o.split(",")||[]).map(function(n){return t(n)(e)}),constructor:a}}if(n){var a=o(n),s=a.callback,l=a.constructor,u=[r,i].concat(a.args);e.$apply((e[s]||e[l][s]).apply(e,u))}};i.create=function(t,n){o(e,r.ngExResizableCreate,t,n)},i.resize=function(t,n){o(e,r.ngExResizableResize,t,n)},i.start=function(t,n){o(e,r.ngExResizableStart,t,n)},i.stop=function(t,n){o(e,r.ngExResizableStop,t,n)},$(n).resizable(i)}}}]),angular.module("angular-spinner",[]).factory("factorySpinnerConstant",function(){return{_START_REQUEST_:"_START_REQUEST_",_END_REQUEST_:"_END_REQUEST_"}}).factory("spinnerInterceptor",["$q","$injector","$timeout","factorySpinnerConstant",function(t,e,n,r){var i,o,a=function(){1>o.pendingRequests.length?i.$broadcast(r._END_REQUEST_):i.$broadcast(r._START_REQUEST_)};return function(n){return o=o||e.get("$http"),i=i||e.get("$rootScope"),i.$broadcast(r._START_REQUEST_),n.then(function(t){return a(),t},function(e){return a(),t.reject(e)})}}]).config(["$httpProvider",function(t){t.responseInterceptors.push("spinnerInterceptor")}]).directive("loadingWidget",["$timeout","factorySpinnerConstant",function(t,e){var n=function(t){t.css("display",t.data("__display"))},r=function(t){t.data("__display",t.css("display")),t.css("display","none")};return{restrict:"A",link:function(t,i){r(i),t.$on(e._START_REQUEST_,function(){n(i)}),t.$on(e._END_REQUEST_,function(){r(i)})}}}]),function(t){var e=function(t){var e=t.module("angular-fullscreen",[]);return e.factory("Fullscreen",["$document",function(t){var e=t[0];return{all:function(){this.enable(e.documentElement)},enable:function(t){t.requestFullScreen?t.requestFullScreen():t.mozRequestFullScreen?t.mozRequestFullScreen():t.webkitRequestFullScreen&&t.webkitRequestFullScreen()},cancel:function(){e.cancelFullScreen?e.cancelFullScreen():e.mozCancelFullScreen?e.mozCancelFullScreen():e.webkitCancelFullScreen&&e.webkitCancelFullScreen()},isEnabled:function(){var t=e.fullscreenElement||e.mozFullScreenElement||e.webkitFullscreenElement;return t}}}]),e.directive("fullscreen",["Fullscreen","$document",function(t,e){return e[0],{link:function(e,n,r){r.fullscreen&&e.$watch(r.fullscreen,function(e){var r=t.isEnabled();e&&!r?t.enable(n[0]):!e&&r&&t.cancel()}),n.on("click",function(){t.enable(n[0])})}}}]),e};"function"==typeof define&&define.amd?define("angular-fullscreen",["angular"],function(t){return e(t)}):e(t.angular)}(window),!function(t){function e(e,n){var r,i,o,a=0;if(arguments.length>2&&(o=t.util.array.toArray(arguments),o.splice(0,2)),e&&e.length)for(r=e.length;r>a;){if(i=n.apply(null,[e[a],a,e].concat(o)),void 0!==i)return i;a+=1}else if(!(e instanceof Array))for(a in e)if(e.hasOwnProperty(a)&&(i=n.apply(null,[e[a],a,e].concat(o)),void 0!==i))return i;return e}function n(e,n){var r,i,o,a=0,s=[];if(arguments.length>2&&(i=t.util.array.toArray(arguments),i.splice(0,2)),e&&e.length)for(r=e.length;r>a;)o=n.apply(null,[e[a],a,e].concat(i)),o&&s.push(e[a]),a+=1;else for(a in e)e.hasOwnProperty(a)&&(o=n.apply(null,[e[a],a,e].concat(i)),o&&s.push(e[a]));return s}function r(t,e,n){function r(t,e){var n,r;r=s[t],r&&(e?(n=r.indexOf(e),-1!==n&&r.splice(n,1)):r.length=0)}function i(t,e){return s[t]=s[t]||[],s[t].push(e),function(){r(t,e)}}function o(e,n){return e&&e.apply(t,n)}function a(t){if(s[t])for(var e=0,n=s[t],r=n.length;r>e;)o(n[e],arguments),e+=1}var s={};e&&n?(t.on=e[n.on]&&e[n.on].bind(e),t.off=e[n.off]&&e[n.off].bind(e),t.dispatch=e[n.dispatch].bind(e)):(t.on=i,t.off=r,t.dispatch=a)}function i(t){var e=[],n=0,r=t.length;if(void 0!==t.length)for(;r>n;)e.push(t[n]),n+=1;else for(n in t)t.hasOwnProperty(n)&&e.push(t[n]);return e}function o(t,e){var n,r,i,o,a;for(e||(e=function(t,e){return t>e?1:e>t?-1:0}),r=t.length,o=r-1,n=0;r>n;n+=1)for(i=0;o>i;i+=1)e(t[i],t[i+1])>0&&(a=t[i+1],t[i+1]=t[i],t[i]=a);return t}function a(e,n){function r(t){return(""+t).split(/\b/)[2]}function i(t,e,n){return{label:r(t),method:t,args:e||[],delay:n}}function o(t){var e=r(t);O[e]=t}function a(t){for(var n=0,r=C.length;r>n;)C[n].label===t.label&&C[n]!==k&&(e.log("clear duplicate item %c%s",P,t.label),C.splice(n,1),n-=1,r-=1),n+=1}function s(t,e,n){var r=i(t,e,n);O[r.label]&&a(r),C.push(r),E&&m()}function l(t,e,n){C.splice(1,0,i(t,e,n))}function u(t){a({label:r(t)})}function c(t,n){var r,o=i(t,[],n),a=Date.now(),s=function(){e.log("exec timeout method %c%s %sms",P,o.label,Date.now()-a),t()};return e.log("wait for timeout method %c%s",P,o.label),r=setTimeout(s,n),_[r]=function(){clearTimeout(r),delete _[r]},r}function h(t){_[t]&&_[t]()}function p(t){var e=""+t,n=e.match(/\(.*\)/);return n[0].match(/([\$\w])+/gm)}function f(t){var e=p(t);return!(!e||-1===e.indexOf("done"))}function d(){return S=Date.now(),e.log("finish %c%s took %dms",P,k.label,S-T),k=null,g(C.shift()),C.length&&m(),S-T}function g(t){for(A.unshift(t);A.length>D;)A.pop()}function m(){!k&&C.length&&(k=C[0],e.async&&void 0!==k.delay?(e.log("	delay for %c%s %sms",P,k.label,k.delay),clearTimeout(w),w=setTimeout(v,k.delay)):v())}function v(){e.log("start method %c%s",P,k.label);var t=f(k.method);t&&k.args.push(d),T=Date.now(),k.method.apply(null,k.args),t||d()}function y(){E=!0,m()}function $(){var t,n=k?1:0;for(e.log("clear");C.length>n;)t=C.splice(n,1)[0],e.log("	remove %s from flow",t.label)}function b(){return C.length}function x(){clearTimeout(w),C.length=0,e=null}var w,T,S,E=!1,k=null,C=[],A=[],D=10,O={},_={},P="color:#666666;";return e=t.logWrapper("Flow",e||{},"grey",n),e.async=e.hasOwnProperty("async")?e.async:!0,e.debug=e.hasOwnProperty("debug")?e.debug:0,e.insert=l,e.add=s,e.unique=o,e.remove=u,e.timeout=c,e.stopTimeout=h,e.run=y,e.clear=$,e.length=b,e.destroy=x,e}function s(n,r,i,o){function s(){be.unique(pe),be.unique(ie),be.unique(Q)}function l(){He.name=n.$eval(i.gridName)||"datagrid",He.scope=n,He.element=r,He.attr=i,He.rowsLength=0,He.scopes=Ce,He.data=He.data||[],He.unwatchers=ke,He.values=Me,He.start=f,He.update=oe,He.reset=pe,He.isReady=$,He.forceRenderScope=fe,He.dispatch=ve,He.render=function(){be.add(ie)},He.updateHeights=ge,He.getOffsetIndex=Y,He.isActive=z,He.isCompiled=k,He.swapItem=w,He.getScope=T,He.getRowItem=S,He.getRowElm=E,He.getRowIndex=He.getIndexOf=C,He.getRowOffset=D,He.getRowHeight=O,He.getViewportHeight=_,He.getContentHeight=P,He.getContent=p,He.safeDigest=L,He.getRowIndexFromElement=A,He.updateViewportHeight=y,He.calculateViewportHeight=b,He.options=Te=t.extend({},t.datagrid.options,n.$eval(i.options)||{}),He.flow=be=new a({async:Te.hasOwnProperty("async")?!!Te.async:!0,debug:Te.hasOwnProperty("debug")?Te.debug:0},He.dispatch),He.grouped=n.$eval(i.grouped),be.add(s),be.run()}function u(){var e,n=r[0].getElementsByClassName(Te.contentClass),i=Te.contentClass;return n=t.filter(n,h),e=n[0],e&&(i=e.className||Te.contentClass),e||(i=c()||i,e=angular.element('<div class="'+i+'"></div>'),He.options.chunks.detachDom&&e.css({position:"relative"}),r.prepend(e)),e[0]||(e=angular.element(e)),e}function c(){var e,n;return we?(e=t.util.array.toArray(we[0].classList),n=e.indexOf("old-"+Te.contentClass),-1!==n&&e.splice(n,1),e.join(" ")):void 0}function h(t){return angular.element(t).hasClass("old-"+Te.contentClass)?!1:!0}function p(){return xe}function f(){He.dispatch(t.datagrid.events.ON_INIT),xe=u(),d(0)}function d(t){if(!He.element[0].offsetHeight){if(1>t)return be.add(d,[t+1],0),void 0;be.warn("Datagrid: Dom Element does not have a height.")}be.add(He.templateModel.createTemplates,null,0),be.add(function(){Te.dynamicRowHeights=He.templateModel.dynamicHeights()}),be.add(g)}function g(){var e=n.$on(t.datagrid.events.ON_BEFORE_RENDER_AFTER_DATA_CHANGE,function(){e(),be.add(ve,[t.datagrid.events.ON_STARTUP_COMPLETE])});window.addEventListener("resize",x),ke.push(n.$on(t.datagrid.events.UPDATE,oe)),ke.push(n.$on(t.datagrid.events.ON_ROW_TEMPLATE_CHANGE,de)),ke.push(n.$on("$destroy",$e)),be.add(m,[],0),He.dispatch(t.datagrid.events.ON_LISTENERS_READY)}function m(){Ee||(He.log("setupChangeWatcher"),Ee=!0,ke.push(n.$watchCollection(i.uxDatagrid,v)),be.add(ie))}function v(t,e){be.add(ce,[t,e])}function y(){_e=He.calculateViewportHeight()}function $(){return Ne===Pe.READY}function b(){return r[0].offsetHeight}function x(){setTimeout(function(){ge()},100)}function w(t,e){var n,r,i=C(t);He.data.hasOwnProperty(i)&&(n=He.templateModel.getTemplate(t),r=He.templateModel.getTemplate(e),He.data[i]=e,n!==r?He.templateModel.setTemplate(i,r):(Ce[i][r.item]=e,L(Ce[i])))}function T(t){return Ce[t]}function S(t){return this.getData()[t]}function E(t){return angular.element(He.chunkModel.getRow(t))}function k(t){return!!Ce[t]}function C(t){return He.getNormalizedIndex(t,0)}function A(t){if(r[0].contains(t[0]||t)){for(var e=t.scope?t.scope():angular.element(t).scope();e&&e.$parent&&e.$parent!==He.scope;)e=e.$parent;return e.$index}return-1}function D(t){return void 0===Oe[t]&&(Te.dynamicRowHeights?G():Oe[t]=t*Te.rowHeight),Oe[t]}function O(t){return He.templateModel.getTemplateHeight(He.data[t])}function _(){return _e}function P(){var t=He.chunkModel.getChunkList();return t&&t.height||0}function R(t){He.log("OVERWRITE DOM!!!");var e=t.length;be.insert(He.chunkModel.chunkDom,[t,Te.chunks.size,'<div class="'+Te.chunks.chunkClass+'">',"</div>",xe]),He.rowsLength=e,He.log("created %s dom elements",e)}function N(t){var e,r,i,a=Ce[t];return a||(a=n.$new(),e=T(t-1),r=He.templateModel.getTemplate(He.data[t]),e&&(e.$$nextSibling=a,a.$$prevSibling=e),a.$status=Te.compiledClass,a[r.item]=He.data[t],a.$index=t,Ce[t]=a,i=E(t),i.removeClass(Te.uncompiledClass),o(i)(a),B(a)),a}function M(t){He.log("	buildRows %s",t.length),Ne=Pe.BUILDING,be.insert(R,[t])}function j(){He.log("	ready"),Ne=Pe.READY,be.add(ie),be.add(H),be.add(L,[n])}function H(){n.$emit(t.datagrid.events.ON_READY)}function L(t){t.$$phase||t.$digest()}function F(t,e,n){for(;t;){for(var r in e)e.hasOwnProperty(r)&&n(t,e,r);t=t.$parent}}function I(t,e){F(t,e,q)}function q(t,e,n){t.$$listenerCount[n]+=e[n]}function W(t,e){F(t,e,V)}function V(t,e,n){t.$$listenerCount[n]-=e[n]}function B(e,n){var r;if(n=n||0,e&&!z(e)){if(n||e.$emit(t.datagrid.events.ON_BEFORE_ROW_DEACTIVATE),e.$$$watchers=e.$$watchers,e.$$watchers=[],n||(e.$$$listenerCount=e.$$listenerCount,e.$$listenerCount=angular.copy(e.$$$listenerCount),W(e,e.$$$listenerCount)),e.$$childHead)for(r=e.$$childHead;r;)B(r,n+1),r=r.$$nextSibling;return!0}return!1}function U(e,n){var r;if(n=n||0,e&&e.$$$watchers){if(e.$$watchers=e.$$$watchers,e.$$$watchers=null,n||(I(e,e.$$$listenerCount),e.$$$listenerCount=null),e.$$childHead)for(r=e.$$childHead;r;)U(r,n+1),r=r.$$nextSibling;return n||e.$emit(t.datagrid.events.ON_AFTER_ROW_ACTIVATE),!0}return!(!e||e.$$$watchers)}function z(t){var e=Ce[t];return!(!e||e.$$$watchers)}function Y(t){var e=Math.floor(t/He.templateModel.averageTemplateHeight()),n=0,r=He.rowsLength;if(!t||2>He.rowsLength)return n;for(Oe[e]&&t>=Oe[e]&&(n=e);r>n;){if(t>=Oe[n]&&Oe[n+1]>t)return n;n+=1}return n}function X(){var t=_e,e=Me.scroll||0,n={startIndex:0,i:0,inc:1,end:He.rowsLength,visibleScrollStart:e+Te.cushion,visibleScrollEnd:e+t-Te.cushion};return n.startIndex=n.i=Y(e),n}function G(){for(var t=0,e=0;He.rowsLength>e;)Oe[e]=t,t+=He.templateModel.getTemplateHeight(He.data[e]),e+=1;Te.rowHeight=He.rowsLength?He.templateModel.getTemplateHeight("default"):0,He.getContent().css({height:P()})}function Q(){var t,e,r,i=X(),o=40*i.i,a=[].concat(Ae);if(!(0>i.i)){for(He.dispatch(Re.ON_BEFORE_UPDATE_WATCHERS,i),J(),Ae.length=0,He.log("	visibleScrollStart %s visibleScrollEnd %s",i.visibleScrollStart,i.visibleScrollEnd);i.i<He.rowsLength&&(r=n.$$childHead?Ce[i.i-1]:null,o=D(i.i),o>=i.visibleScrollStart&&i.visibleScrollEnd>=o&&(e=N(i.i),void 0===i.started&&(i.started=i.i),te(i.i),U(e)&&(t=a.indexOf(i.i),-1!==t&&a.splice(t,1),Ae.push(i.i),L(e),e.$digested=!0)),i.i+=i.inc,!(i.inc>0&&o>i.visibleScrollEnd||0>i.inc&&i.visibleScrollStart>o)););i.ended=i.i-1,He.log("	startIndex %s endIndex %s",i.startIndex,i.i),K(a),De=i.visibleScrollStart,He.log("	activated %s",Ae.join(", ")),Z(),He.dispatch(Re.ON_AFTER_UPDATE_WATCHERS,i)}}function K(t){for(var e,n=[];t.length;)e=t.pop(),n.push(e),B(Ce[e]);He.log("	deactivated %s",n.join(", "))}function Z(){if(Ae.length){var t,e=Ae[Ae.length-1],r=0,i=Ae.length;for(n.$$childHead=Ce[Ae[0]],n.$$childTail=Ce[e];i>r;)t=Ce[Ae[r]],t.$$prevSibling=Ce[Ae[r-1]],t.$$nextSibling=Ce[Ae[r+1]],t.$parent=n,r+=1}}function J(){Me.activeRange.min=Me.activeRange.max=-1}function te(t){Me.activeRange.min=t>Me.activeRange.min&&Me.activeRange.min>=0?Me.activeRange.min:t,Me.activeRange.max=Me.activeRange.max>t&&Me.activeRange.max>=0?Me.activeRange.max:t}function ee(){Me.dirty&&ve(t.datagrid.events.ON_BEFORE_RENDER_AFTER_DATA_CHANGE)}function ne(){var e;Me.dirty&&Me.activeRange.max>=0&&(Me.dirty=!1,e=E(Me.activeRange.min)[0].offsetHeight,He.getData().length&&e!==He.templateModel.getTemplateHeight(He.getData()[Me.activeRange.min])&&He.templateModel.updateTemplateHeights(),ve(t.datagrid.events.ON_RENDER_AFTER_DATA_CHANGE))}function re(){return _e?(Se&&He.info("datagrid has height of %s.",_e),!0):(Se+=1,2>Se?(He.info("datagrid is waiting for element to have a height."),be.add(He.updateViewportHeight,null,0),be.add(ie)):be.warn("Datagrid: Unable to determine a height for the datagrid. Cannot render. Exiting."),!1)}function ie(){if(He.log("render"),re())if(Se=0,He.log("	render %s",Ne),Ne===Pe.BUILDING)be.length()?(be.insert(j),be.insert(G,null,0),be.insert(M,[He.data])):(be.add(M,[He.data],0),be.add(G),be.add(j));else{if(Ne!==Pe.READY)throw Error("RENDER STATE INVALID");He.dispatch(t.datagrid.events.ON_BEFORE_RENDER),be.add(ee),be.add(Q),be.add(ne,null,0),be.add(He.dispatch,[t.datagrid.events.ON_AFTER_RENDER])}else He.log("	not ready to render.")}function oe(){He.warn("force update"),ce(n.$eval(i.uxDatagrid),He.data)}function ae(t,e){if(t&&e&&t.length===e.length){for(var n=0,r=t.length;r>n;){if(se(t[n],e[n]))return!0;n+=1}return He.data.length!==He.normalize(t,He.grouped).length?(He.log("	dirtyCheckData length is different"),!0):!1}return!0}function se(t,e){return He.templateModel.getTemplate(t)!==He.templateModel.getTemplate(e)?(He.log("	dirtyCheckData row template changed"),!0):!1}function le(e){He.log("	mapData()"),He.data=He.setData(e,He.grouped)||[],t.each(He.getData(),ue)}function ue(t,e){var n;Ce[e]&&(n=He.templateModel.getTemplate(t),Ce[e][n.item]=t)}function ce(e,r){if(He.log("onDataChanged"),He.grouped=n.$eval(i.grouped),r!==He.getOriginalData()&&(r=He.getOriginalData()),He.options.smartUpdate&&He.data.length&&!ae(e,r))Me.dirty=!0,le(e),ie();else{var o=ve(t.datagrid.events.ON_BEFORE_DATA_CHANGE,e,r);o.defaultPrevented&&o.newValue&&(e=o.newValue),Me.dirty=!0,be.add(he,[e,r])}}function he(e,n){He.log("	changeData"),ve(t.datagrid.events.ON_BEFORE_RESET),He.data=He.setData(e,He.grouped)||[],ve(t.datagrid.events.ON_AFTER_DATA_CHANGE,He.data,n),pe()}function pe(){He.info("reset start"),be.clear(),ye(),Oe={},Ae.length=0,Ce.length=0,xe.children().unbind(),xe.children().remove(),He.chunkModel.reset(He.data,xe,Ce),He.rowsLength=He.data.length,G(),y(),ie(),be.add(He.info,["reset complete"]),be.add(ve,[t.datagrid.events.ON_AFTER_RESET],0),be.add(ve,[t.datagrid.events.ON_AFTER_HEIGHTS_UPDATED_RENDER])}function fe(t){var e=Ce[t];!e&&t>=0&&He.rowsLength>t&&(e=N(t)),e&&!n.$$phase&&(U(e),e.$digest(),B(e),e.$digested=!0)}function de(t,e){var r=He.getNormalizedIndex(e),i=E(r),o=i.hasClass(Te.uncompiledClass)?N(r):i.scope();o!==n&&(o.$destroy(),Ce[r]=null,i.replaceWith(He.templateModel.getTemplate(e).template),Ce[r]=N(r),ge(r))}function ge(e){be.add(y),be.add(He.chunkModel.updateAllChunkHeights,[e]),be.add(G),be.add(ie),be.add(He.dispatch,[t.datagrid.events.ON_AFTER_HEIGHTS_UPDATED_RENDER])}function me(t){return-1!==je.indexOf(t)}function ve(t){return!me(t)&&Te.debug&&1===Te.debug.all&&He.log("$emit %s",t),n.$emit.apply(n,arguments)}function ye(){var t,r,i=0;e(Ce,function(e,n){if(e){for(e.$$prevSibling=t||void 0,i=n;!r&&He.rowsLength>i;)i+=1,r=Ce[i]||void 0;U(e),t=e,e.$destroy()}}),n.$$childHead=void 0,n.$$childTail=void 0,Ce.length=0}function $e(){for(n.datagrid=null,He.log("destroying grid"),window.removeEventListener("resize",x),clearTimeout(Me.scrollingStopIntv),be.destroy(),He.flow=void 0,be=null;ke.length;)ke.pop()();He.destroyLogger();for(var t in He)He[t]&&He[t].hasOwnProperty("destroy")&&(He[t].destroy(),He[t]=null);ye(),r.remove(),delete n.$parent[He.name],Oe=null,He=null,n=null,r=null,i=null,ke=null,xe=null,Ae.length=0,Ae=null,Ce.length=0,Ce=null,Me=null,Pe=null,Re=null,Te=null,Me=null,je=null,o=null}var be,xe,we,Te,Se=0,Ee=!1,ke=[],Ce=[],Ae=[],De=0,Oe={},_e=0,Pe=t.datagrid.states,Re=t.datagrid.events,Ne=Pe.BUILDING,Me={dirty:!1,scroll:0,speed:0,absSpeed:0,scrollPercent:0,touchDown:!1,scrollingStopIntv:null,activeRange:{min:0,max:0}},je=[t.datagrid.events.LOG,t.datagrid.events.INFO,t.datagrid.events.WARN,t.datagrid.events.ERROR],He={};return t.logWrapper("datagrid event",He,"grey",ve),t.logWrapper("datagrid",He,"green",ve),n.datagrid=He,l(),He}function l(t){this.uid=l.uid++,this.enabled=!0,this.min=0,this.max=0,this.templateStart="",this.templateEnd="",this.parent=null,this.mode=t?l.DETACHED:l.ATTACHED,this.detachDom=t,this.index=0}var u;try{u=angular.module("ux",["ng"])}catch(c){u=angular.module("ux")}t.datagrid={isIOS:!!navigator.userAgent.match(/(iPad|iPhone|iPod)/g),states:{BUILDING:"datagrid:building",READY:"datagrid:ready"},events:{ON_INIT:"datagrid:onInit",ON_LISTENERS_READY:"datagrid:onListenersReady",ON_READY:"datagrid:onReady",ON_STARTUP_COMPLETE:"datagrid:onStartupComplete",ON_BEFORE_RENDER:"datagrid:onBeforeRender",ON_AFTER_RENDER:"datagrid:onAfterRender",ON_BEFORE_UPDATE_WATCHERS:"datagrid:onBeforeUpdateWatchers",ON_AFTER_UPDATE_WATCHERS:"datagrid:onAfterUpdateWatchers",ON_BEFORE_DATA_CHANGE:"datagrid:onBeforeDataChange",ON_AFTER_DATA_CHANGE:"datagrid:onAfterDataChange",ON_BEFORE_RENDER_AFTER_DATA_CHANGE:"datagrid:onBeforeRenderAfterDataChange",ON_RENDER_AFTER_DATA_CHANGE:"datagrid:onRenderAfterDataChange",ON_ROW_TEMPLATE_CHANGE:"datagrid:onRowTemplateChange",ON_SCROLL:"datagrid:onScroll",ON_BEFORE_RESET:"datagrid:onBeforeReset",ON_AFTER_RESET:"datagrid:onAfterReset",ON_AFTER_HEIGHTS_UPDATED_RENDER:"datagrid:onAfterHeightsUpdatedRender",ON_BEFORE_ROW_DEACTIVATE:"datagrid:onBeforeRowDeactivate",ON_AFTER_ROW_ACTIVATE:"datagrid:onAFterRowActivate",RESIZE:"datagrid:resize",UPDATE:"datagrid:update",SCROLL_TO_INDEX:"datagrid:scrollToIndex",SCROLL_TO_ITEM:"datagrid:scrollToItem",SCROLL_INTO_VIEW:"datagrid:scrollIntoView",LOG:"datagrid:log",INFO:"datagrid:info",WARN:"datagrid:warn",ERROR:"datagrid:error"},options:{async:!0,updateDelay:100,creepRender:{enable:!0},creepStartDelay:1e3,cushion:-100,chunks:{detachDom:null,size:50,chunkClass:"datagrid-chunk",chunkDisabledClass:"datagrid-chunk-disabled",chunkReadyClass:"datagrid-chunk-ready"},chunkSize:50,compiledClass:"compiled",uncompiledClass:"uncompiled",contentClass:"datagrid-content",rowClass:"datagrid-row",renderThreshold:1,renderThresholdWait:50,renderWhileScrolling:!1,creepLimit:500,smartUpdate:!0},coreAddons:[]},u.factory("gridAddons",["$injector",function(t){function e(e,n){for(var r,i,o=0,a=e.length;a>o;){if(r=t.get(e[o]),"function"!=typeof r)throw Error("Addons expect a function to pass the grid instance to.");i=t.invoke(r,n,{inst:n}),o+=1}}return function(t,n){n=n instanceof Array?n:n&&n.replace(/,/g," ").replace(/\s+/g," ").split(" ")||[],t.addons&&(n=t.addons=t.addons.concat(n)),e(n,t)}}]),t.css=function(){function t(t){return e(t)||(l[t]=n(t)),e(t)}function e(t){return l[t]}function n(t){if(document.styleSheets&&0!==document.getElementsByTagName(c.head).length){var e,n,r,i;if(document.styleSheets.length>0)for(r=0;document.styleSheets.length>r&&(document.styleSheets[r].disabled||(i=document.styleSheets[r].media,n=typeof i,n===c.string?(""===i||-1!==i.indexOf(c.screen))&&(e=document.styleSheets[r]):n===c.object&&(""===i.mediaText||-1!==i.mediaText.indexOf(c.screen))&&(e=document.styleSheets[r]),e===void 0));r++);var o=document.createElement("style");for(o.type="text/css",o.title=t,document.getElementsByTagName(c.head)[0].appendChild(o),r=0;document.styleSheets.length>r;r++)document.styleSheets[r].disabled||(e=document.styleSheets[r]);return{name:t,styleSheet:e}}}function r(n,r,i){var o,a=e(n)||t(n),s=a.styleSheet;if(s.addRule){for(o=0;s.rules.length>o;o++)if(s.rules[o].selectorText&&s.rules[o].selectorText.toLowerCase()===r.toLowerCase())return s.rules[o].style.cssText=i,void 0;s.addRule(r,i)}else if(s.insertRule){for(o=0;s.cssRules.length>o;o++)if(s.cssRules[o].selectorText&&s.cssRules[o].selectorText.toLowerCase()===r.toLowerCase())return s.cssRules[o].style.cssText=i,void 0;s.insertRule(r+"{"+i+"}",0)}}function i(t){var e,n,r,i,a;if(-1!==t.indexOf("{")||-1!==t.indexOf("}"))return null;if(u[t])return u[t];for(e=0,n=document.styleSheets.length;n>e;e+=1)if(r=document.styleSheets[e],i=r.rules||r.cssRules,a=o(i,t))return a;return null}function o(t,e){var n,r,i,a;if(t)for(n=0,r=t.length;r>n;n+=1){if(i=t[n],i.cssRules&&(a=o(i.cssRules,e)))return a;if(i.selectorText){var s="(\b)*"+e.replace(".","\\.")+"([^-a-zA-Z0-9]|,|$)",l=i.selectorText.match(s);if(l&&-1!==l.indexOf(e))return u[e]=i.style,i.style}}return null}function a(t,e){var n=i(t);return n&&void 0!==n[e]?n[e]:null}function s(t,e,n){var r=i(t);r[e]=n}var l={},u={},c={head:"head",screen:"screen",string:"string",object:"object"};return{createdStyleSheets:[],createStyleSheet:n,createClass:r,getCSSValue:a,setCSSValue:s}}(),t.each=e,t.filter=n,t.extend=function(e){for(var n,r,i=t.util.array.toArray(arguments),o=1,a=i.length;a>o;){n=i[o];for(r in n)e[r]=e[r]&&"object"==typeof e[r]?t.extend(e[r],n[r]):n[r];o+=1}return e},t.util=t.util||{},t.util.array=t.util.array||{},t.util.array.toArray=i,t.util.array.sort=o,t.logWrapper=function(e,n,r,i){return r=r||"black",i=i||n.dispatch||function(){},n.$logName=e,n.log=n.info=n.warn=n.error=function(){},n.log=function(){var o=[t.datagrid.events.LOG,e,r].concat(t.util.array.toArray(arguments));i.apply(n,o)},n.info=function(){var o=[t.datagrid.events.INFO,e,r].concat(t.util.array.toArray(arguments));i.apply(n,o)},n.warn=function(){var o=[t.datagrid.events.WARN,e,r].concat(t.util.array.toArray(arguments));i.apply(n,o)},n.error=function(){var o=[t.datagrid.events.ERROR,e,r].concat(t.util.array.toArray(arguments));i.apply(n,o)},n.destroyLogger=function(){n.logger&&(n.log("destroy"),n.logger.destroy(),n.logger=null)},n},t.datagrid.Flow=a,u.directive("uxDatagrid",["$compile","gridAddons",function(n,r){return{restrict:"AE",scope:!0,link:{pre:function(i,o,a){var l=new s(i,o,a,n);e(t.datagrid.coreAddons,function(t){t.apply(l,[l])}),r(l,a.addons)},post:function(t){t.datagrid.start()}}}}]),t.datagrid.coreAddons.chunkModel=function(e){function n(){return x}function i(t,n,r,o){for(var a,s,u=0,c=t.length,h=new l(e.options.chunks.detachDom);c>u;)s=t[u],0===u%n&&(a&&a.updateHeight(e.templateModel,w),a=new l(e.options.chunks.detachDom),a.min=s.min||u,a.templateModel=e.templateModel,a.templateStart=r,a.templateEnd=o,a.parent=h,a.index=h.length,h.push(a)),s instanceof l&&(s.parent=a),s instanceof l&&(s.index=a.length),a.push(s),a.max=s.max||u,u+=1;return a&&a.updateHeight(e.templateModel,w),h.min||(h.min=h[0]?h[0].min:0,h.max=h[h.length-1]?h[h.length-1].max:0,h.templateStart=r,h.templateEnd=o,h.updateHeight(e.templateModel,w),h.dirtyHeight=!1),h.length>n?i(h,n,r,o):h}function o(t){var n,r;void 0===t?x&&(x.forceHeightReCalc(e.templateModel,w),x.updateHeight(e.templateModel,w,1,!0)):(n=u(t,x),r=a(n,x),r.updateHeight(e.templateModel,w,-1,!0))}function a(t,e){for(var n;t.length;)n=t.shift(),e[n]instanceof l&&(e=e[n]);return e}function s(t,e,n,r,o){return C.log("chunkDom"),S=o,T=e,w=t,E=n,k=r,x=i(t,e,n,r),v(x),x.updateDomHeight(1),o}function u(t,e,n){var r,i=0,o=e.length;for(n=n||[];o>i;){if(r=e[i],!(r instanceof l)){n.push(t%T);break}if(t>=r.min&&r.max>=t){n.push(i),u(t,r,n);break}i+=1}return n}function c(t){var e=u(t,x),n=f(e);return n&&n.length&&void 0===n.attr("row-id")&&n.attr("row-id",t),n}function h(t,e){for(var n,r=0,i=t.slice(0),o=x,a=S;i.length>r;)n=i.shift(),!o.rendered&&e&&(e(a,o),o.rendered=a,v(o)),i.length||g(o),o=o[n],a=o.rendered||angular.element(a.children()[n]);return a}function p(n,r){var i;n.html(r.getChildrenStr()),i=n.children(),t.each(i,d),-1!==i[0].className.indexOf(e.options.chunks.chunkClass)&&i.addClass(e.options.chunks.chunkReadyClass)}function f(t){return h(t,p)}function d(t){window.getComputedStyle(t).getPropertyValue("top")}function g(t){return t.compiled||(t.compiled=m(t),t.compiled&&(t.parent&&g(t.parent),e.flow.add($))),t.compiled}function m(t){var n,r;if(t[0]instanceof l){for(n=0,r=t.length;r>n;){if(!t[n].compiled)return!1;n+=1}return!0}for(n=t.min,r=t.max;r>n;){if(!e.isCompiled(n))return!1;n+=1}return!0}function v(t){t.updateDom(e.options.chunks.chunkDisabledClass)}function y(t,e){C.log("reset"),A.length=0,t=t||[],x&&(x.destroy(),x=null,S=null,w=null),s(t,T,E,k,e)}function $(){var t=e.values.activeRange,n=e.options.chunks;x.enableRange(t.min,t.max,n.chunkDisabledClass),n.detachDom&&v(x)}function b(){y(),x=null,w=null,T=null,S=null,E=null,k=null,A.length=0,A=null,e.chunkModel=null,C.destroyLogger(),C=null,e=null}var x,w,T,S,E,k,C=t.logWrapper("chunkModel",{},"purple",e.dispatch),A=[];return e.flow.unique(v),C.chunkDom=s,C.getChunkList=n,C.getRowIndexes=function(t){return u(t,x)},C.getRow=c,C.reset=y,C.updateAllChunkHeights=o,C.destroy=b,e.scope.$on(t.datagrid.events.ON_AFTER_UPDATE_WATCHERS,$),r(C),e.chunkModel=C,C},t.datagrid.coreAddons.push(t.datagrid.coreAddons.chunkModel),l.uid=0,l.DETACHED="chunkArray:detached",l.ATTACHED="chunkArray:attached",l.prototype=[],l.prototype.getStub=function(t){return this.templateStart+t+this.templateEnd},l.prototype.inRange=function(t){return t>=this.min&&this.max>=t},l.prototype.rangeOverlap=function(t,e,n){var r=!1;for(n=n>0?n:0,t-=n,e+=n;e>t;){if(this.inRange(t)){r=!0;break}t+=1}return r},l.prototype.each=function(t,e){for(var n=0,r=this.length;r>n;)t.apply(this[n],e),n+=1},l.prototype.getChildrenStr=function(t){for(var e=0,n=this.length,r="",i=this;n>e;)r+=i[e]instanceof l?i[e].getStub(t?i[e].getChildrenStr(t):""):this.templateModel.getTemplate(i[e]).template,e+=1;return r},l.prototype.updateHeight=function(t,e,n,r){var i,o=0,a=0;if(this[0]instanceof l)for(i=this.length;i>o;)1===n&&this[o].updateHeight(t,e,n,r),a+=this[o].height,o+=1;else a=t.getHeight(e,this.min,this.max);this.height!==a&&(this.dirtyHeight=!0,this.height=a),-1==n&&this.dirtyHeight&&this.parent&&this.parent.updateHeight(t,e,n,r),r&&this.dirtyHeight&&this.updateDomHeight()},l.prototype.getPreviousSibling=function(){var t,e;return this.parent&&(e=this.index-1,t=this.parent[e],t&&t.index===this.index-1||this.parent.parent&&(t=this.parent.getPreviousSibling(),t&&(t=t.last()))),t},l.prototype.getNextSibling=function(){var t,e;return this.parent&&(e=this.index+1,t=this.parent[e],t&&t.index===this.index+1||this.parent.parent&&(t=this.parent.getNextSibling(),t&&(t=t.first()))),t},l.prototype.first=function(){return this[0]},l.prototype.last=function(){return this[this.length-1]},l.prototype.calculateTop=function(){var t,e=0;return this.index&&this.parent&&(t=this.getPreviousSibling(),t&&(e=t.top+t.height)),this.top=e,this.top},l.prototype.forceHeightReCalc=function(t,e){var n,r=0,i=0;if(this[0]instanceof l)for(n=this.length;n>r;)i+=this[r].forceHeightReCalc(t,e),r+=1;else i=t.getHeight(e,this.min,this.max);return this.height!==i&&(this.height=i,this.setDirtyHeight()),this.height},l.prototype.setDirtyHeight=function(){for(var t=this;t;)t.dirtyHeight=!0,t=t.parent
},l.prototype.getId=function(){if(this._index!==this.index||!this._id){var t=this,e="";for(this._index=this.index;t;)e="."+t.index+e,t=t.parent;this._id=e.substr(1,e.length)}return this._id},l.prototype.hasChildChunks=function(){return this._hasChildChunks||(this._hasChildChunks=this.first()instanceof l),this._hasChildChunks},l.prototype.enableRange=function(t,e,n){this.rangeOverlap(t,e,this.detachDom)?this.enable(n):this.disable(n),this.hasChildChunks()&&this.each(this.enableRange,[t,e,n])},l.prototype.enable=function(t){this.enabled||(this.enabled=!0,this.updateDom(t),this.parent&&this.parent.enable(t))},l.prototype.disable=function(t){var e,n=0;if(this.compiled){if(this.hasChildChunks())for(e=this.length;e>n;)this[n].disable(t),n+=1;this.enabled&&(this.enabled=!1,this.updateDom(t))}},l.prototype.updateDom=function(t){this.rendered&&(!this.rendered.attr("chunk-id"),this.compiled&&!this.rendered.attr("compiled")&&this.rendered.attr("compiled",!0),this.detachDom?this.enabled?this.detached&&(this.detached=!1,this.parent.rendered.append(this.rendered)):this.enabled||this.detached||this.parent&&this.parent.compiled&&this.rendered.parent().length&&(this.detached=!0,this.rendered.remove()):(this.rendered.attr("enabled",this.enabled),this.enabled?(this.rendered.removeAttr("disabled"),this.rendered.removeAttr("read-only"),this.rendered.removeClass(t)):(this.rendered.attr("disabled","disabled"),this.rendered.attr("read-only",!0),this.rendered.addClass(t))),this.each(this.updateDom,[t]))},l.prototype.updateDomHeight=function(t){this.mode===l.DETACHED&&this.calculateTop(),this.rendered?(this.dirtyHeight=!1,this.mode===l.DETACHED&&(this.rendered[0].style.top=this.top+"px"),this.rendered[0].style.height=this.height+"px"):this.createDomTemplates(),-1===t&&this.parent?this.parent.updateDomHeight(t):t&&this.hasChildChunks()&&this.each(this.updateDomHeight,[t])},l.prototype.createDomTemplates=function(){if(!this.templateReady){var t=this.templateStart.substr(0,this.templateStart.length-1)+' style="';this.mode===l.DETACHED&&(t+="position:absolute;top:"+this.top+"px;left:0px;"),this.templateStart=t+"width:100%;height:"+this.height+'px;">',this.templateReady=!0}},l.prototype.children=function(){var t=[];this.each(function(){t.push(this.rendered)},[])},l.prototype.destroy=function(){for(this.hasChildChunks()&&this.each(this.destroy),this.templateStart="",this.templateEnd="",this.templateModel=null,this.rendered=null,this.parent=null;this.length;)this.pop();this.length=0},t.datagrid.events.ON_RENDER_PROGRESS="datagrid:onRenderProgress",t.datagrid.coreAddons.creepRenderModel=function(n){function r(t){var e=n.getScope(t);e&&e.$digested||n.forceRenderScope(t)}function i(){var t={count:0};return e(n.scopes,o,t),t.count>=n.rowsLength&&S.disable(),{count:t.count,len:n.rowsLength}}function o(t,e,n,r){r.count+=t?1:0}function a(t,e,r){n.values.touchDown||($=!1,b=Date.now()+n.options.renderThreshold,E=t,k=e,u(c,r))}function s(e,r){var i=t.util.array.toArray(arguments);return i.splice(0,2),n.options.async?(clearTimeout(y),y=setTimeout(function(){e.apply(null,i)},r)):e.apply(this,i),y}function l(t,e){for(;t>=0&&n.rowsLength>t&&n.isCompiled(t);)t+=e;return t>=0&&n.rowsLength>t?t:e>0?n.rowsLength:-1}function u(t,e){var i=Date.now();b>i&&h()?(E=e?E:l(E,-1),E>=0&&(r(E),e&&(E-=1)),k=e?k:l(k,1),k!==n.rowsLength&&(r(k),e&&(k+=1)),u(t,e)):t()}function c(){if(p(),h()){T+=1,n.values.touchDown||n.values.speed||!h()||f(E,k);var e=i();e!==x&&n.dispatch(t.datagrid.events.ON_RENDER_PROGRESS,e)}else T=0,S.disable(),x=1,n.dispatch(t.datagrid.events.ON_RENDER_PROGRESS,1)}function h(){return!!(E>-1||n.rowsLength>k)}function p(){b=0,clearTimeout(w),clearTimeout(y),w=0}function f(t,e,r,i){p(),n.options.creepLimit>T&&(w=s(a,r||n.options.renderThresholdWait,t,e,i))}function d(t,e){f(E,k,n.options.creepStartDelay,e)}function g(){p()}function m(t,e,n){T=0,E=e.started||0,k=e.ended||0,d(t,n)}function v(t){g(t),n.options.creepRender&&n.options.creepRender.enable!==!1&&S.enable()}var y,$,b,x,w=0,T=0,S=t.logWrapper("creepModel",{},"blue",n.dispatch),E=0,k=0,C=[];S.stop=p,S.destroy=function(){S.disable(),p(),n=null,S=null},S.enable=function(){C.length||(C.push(n.scope.$on(t.datagrid.events.BEFORE_VIRTUAL_SCROLL_START,g)),C.push(n.scope.$on(t.datagrid.events.ON_VIRTUAL_SCROLL_UPDATE,g)),C.push(n.scope.$on(t.datagrid.events.ON_TOUCH_DOWN,g)),C.push(n.scope.$on(t.datagrid.events.ON_SCROLL_START,g)),C.push(n.scope.$on(t.datagrid.events.ON_AFTER_UPDATE_WATCHERS,m)))},S.disable=function(){for(S.info("creep Disabled");C.length;)C.pop()()},n.unwatchers.push(n.scope.$on(t.datagrid.events.ON_BEFORE_RESET,v)),n.creepRenderModel=S,n.options.creepRender&&n.options.creepRender.enable?S.enable():S.disable()},t.datagrid.coreAddons.push(t.datagrid.coreAddons.creepRenderModel),t.datagrid.coreAddons.normalizeModel=function(e){function n(t,r,i,o,a){var s;return a=a.slice(0),a.push(r),t===o?a:t[e.grouped]&&t[e.grouped].length&&(s=ux.each(t[e.grouped],n,o,a),s&&s!==t[e.grouped])?s:void 0}var r,i,o=t.logWrapper("normalizeModel",{},"grey",e.dispatch);return e.normalize=function(t,n,r){t=t||[];var i=0,o=t.length;for(r=r||[];o>i;)r.push(t[i]),t[i]&&t[i][n]&&e.normalize(t[i][n],n,r),i+=1;return r},e.setData=function(t,n){return o.log("setData"),r=t,i=n?e.normalize(t,n):t&&t.slice(0)||[]},e.getData=function(){return i},e.getOriginalData=function(){return r},e.getOriginalIndexOfItem=function(t){var e=ux.each(r,n,t,[]);return e&&e!==r?e:[]},e.getNormalizedIndex=function(t,n){for(var r=n||0;e.rowsLength>r;){if(e.data[r]===t)return r;r+=1}if(n)for(r=n;r>=0;){if(e.data[r]===t)return r;r-=1}return-1},o.destroy=function(){o.destroyLogger(),r=null,i=null,e.normalizeModel=null,e=null,o=null},e.normalizeModel=o,e},t.datagrid.coreAddons.push(t.datagrid.coreAddons.normalizeModel),t.datagrid.events.ON_SCROLL_START="datagrid:scrollStart",t.datagrid.events.ON_SCROLL_STOP="datagrid:scrollStop",t.datagrid.events.ON_TOUCH_DOWN="datagrid:touchDown",t.datagrid.events.ON_TOUCH_UP="datagrid:touchUp",t.datagrid.coreAddons.scrollModel=function(e){function n(){h(),e.element.css("overflow")||e.element.css({overflow:"auto"}),g.log("addScrollListener"),r(),e.unwatchers.push(e.scope.$on(t.datagrid.events.SCROLL_TO_INDEX,function(t,n){e.scrollModel.scrollToIndex(n,!0)})),e.unwatchers.push(e.scope.$on(t.datagrid.events.SCROLL_TO_ITEM,function(t,n){e.scrollModel.scrollToItem(n,!0)})),e.unwatchers.push(e.scope.$on(t.datagrid.events.SCROLL_INTO_VIEW,function(t,n){e.scrollModel.scrollIntoView(n,!0)})),a(),m=!0}function r(){v=!0,e.element[0].addEventListener("scroll",s)}function i(){v&&(g.removeScrollListener(),v=!0),g.removeTouchEvents()}function o(){v&&r(),a()}function a(){g.log("addTouchEvents");var t=e.getContent();t.bind("touchstart",g.onTouchStart),t.bind("touchend",g.onTouchEnd),t.bind("touchcancel",g.onTouchEnd)}function s(t){e.scrollModel.onUpdateScroll(t)}function l(){d=Date.now(),e.scrollModel.onScrollingStop()}function u(t){e.data[t-1]&&!e.isCompiled(t-1)&&e.forceRenderScope(t-1),e.data[t+1]&&!e.isCompiled(t+1)&&e.forceRenderScope(t+1)}function c(){clearTimeout(p),g.destroyLogger(),h(),m&&(g.removeScrollListener(),g.removeTouchEvents()),g=null,e=null}var h,p,f,d,g=t.logWrapper("scrollModel",{},"orange",e.dispatch),m=!1,v=!1;return g.fireOnScroll=function(){e.values.scroll!==f&&(f=e.values.scroll,e.dispatch(t.datagrid.events.ON_SCROLL,e.values))},g.removeScrollListener=function(){g.log("removeScrollListener"),e.element[0].removeEventListener("scroll",s)},g.removeTouchEvents=function(){m&&(g.log("removeTouchEvents"),e.getContent().unbind("touchstart",g.onTouchStart),e.getContent().unbind("touchend",g.onTouchEnd),e.getContent().unbind("touchcancel",g.onTouchEnd))},g.onTouchStart=function(n){e.values.touchDown=!0,e.dispatch(t.datagrid.events.ON_TOUCH_DOWN,n)},g.onTouchEnd=function(n){e.values.touchDown=!1,e.dispatch(t.datagrid.events.ON_TOUCH_UP,n)},g.getScroll=function(t){return(t||e.element[0]).scrollTop},g.setScroll=function(t){e.element[0].scrollTop=t,e.values.scroll=t},g.onUpdateScroll=function(n){var r=e.scrollModel.getScroll(n.target||n.srcElement);e.values.scroll!==r&&(e.dispatch(t.datagrid.events.ON_SCROLL_START,r),e.values.speed=r-e.values.scroll,e.values.absSpeed=Math.abs(e.values.speed),e.values.scroll=r,e.values.scrollPercent=(100*(e.values.scroll/e.getContentHeight())).toFixed(2)),e.scrollModel.waitForStop(),g.fireOnScroll()},g.scrollTo=function(t,n){e.scrollModel.setScroll(t),n?e.scrollModel.onScrollingStop():e.scrollModel.waitForStop()},g.clearOnScrollingStop=function(){g.onScrollingStop()},g.waitForStop=function(){var t=!1;clearTimeout(p),e.options.renderWhileScrolling&&Date.now()-(e.options.renderWhileScrolling>0||0)>d&&(t=!0),t||!e.flow.async&&!e.values.touchDown?l():p=setTimeout(l,e.options.updateDelay)},g.onScrollingStop=function(){e.values.speed=0,e.values.absSpeed=0,e.render(),g.fireOnScroll(),e.dispatch(t.datagrid.events.ON_SCROLL_STOP,e.values)},g.scrollToIndex=function(t,n){g.log("scrollToIndex");var r=e.getRowOffset(t);return e.scrollModel.scrollTo(r,n),r},g.scrollToItem=function(t,n){g.log("scrollToItem");var r=e.getNormalizedIndex(t);return-1!==r?e.scrollModel.scrollToIndex(r,n):e.values.scroll},g.scrollIntoView=function(t,n){g.log("scrollIntoView");var r,i,o="number"==typeof t?t:e.getNormalizedIndex(t),a=e.getRowOffset(o);return Math.abs(e.options.cushion),u(o),e.values.scroll>a?(e.scrollModel.scrollTo(a,n),void 0):(e.updateViewportHeight(),i=e.getViewportHeight(),r=e.templateModel.getTemplateHeight(e.getData()[o]),a>=e.values.scroll+i-r&&e.scrollModel.scrollTo(a-i+r,n),void 0)},g.scrollToTop=function(t){g.log("scrollToTop"),e.scrollModel.scrollTo(0,t)},g.scrollToBottom=function(t){g.log("scrollToBottom");var n=e.getContentHeight()-e.getViewportHeight();e.scrollModel.scrollTo(n>=0?n:0,t)},h=e.scope.$on(t.datagrid.events.ON_READY,n),e.unwatchers.push(e.scope.$on(t.datagrid.events.ON_BEFORE_RESET,i)),e.unwatchers.push(e.scope.$on(t.datagrid.events.ON_AFTER_RESET,o)),g.destroy=c,e.scrollModel=g,e},t.datagrid.coreAddons.push(t.datagrid.coreAddons.scrollModel),t.datagrid.coreAddons.templateModel=function(e){"use strict";function n(t){return t=t.replace(/\n/g,""),t=t.replace(/[\t ]+</g,"<"),t=t.replace(/>[\t ]+</g,"><"),t=t.replace(/>[\t ]+$/g,">")}return e.templateModel=function(){function r(){x.log("createTemplates");var t,n=e.element[0].getElementsByTagName("script"),r=n.length;if(!r)throw Error("at least one template is required.");for(t=0;r>t;t+=1)i(n[t]);for(;n.length;)e.element[0].removeChild(n[0])}function i(t){var r,i=n(angular.element(t).html()),a=document.createElement("div"),s=o(t,"template-name")||b;if(a.className="grid-template-wrapper",i=angular.element(i)[0],i.className+=" "+e.options.rowClass+" "+e.options.uncompiledClass+" {{$status}}",i.setAttribute("template",s),e.getContent()[0].appendChild(a),a.appendChild(i),i=n(a.innerHTML),r={name:s,item:o(t,"template-item"),template:i,height:a.offsetHeight},x.log("template: %s %o",s,r),!r.height)throw Error("Template height cannot be 0.");return $[r.name]=r,$.push(r),e.getContent()[0].removeChild(a),y=0,r}function o(t,e){var n=t.attributes["data-"+e]||t.attributes[e];return n&&n.nodeValue||""}function a(){return $}function s(t){return t.attr?t.attr("template"):t.getAttribute("template")}function l(t){return $[t]?$[t]:$[b]}function u(){var t,e;for(t in $)if($.hasOwnProperty(t)&&(e=e||$[t].height,e!==$[t].height))return!0;return!1}function c(){var t=0,e=$.length;if(!y)for(;e>t;)y+=$[t].height,t+=1;return y/e}function h(){return $.length}function p(t){var e=x.getTemplate(t);return e?e.height:0}function f(t,e,n){var r=e,i=0;if(!t.length)return 0;for(;n>=r;)i+=x.getTemplateHeight(t[r]),r+=1;return i}function d(t,e){t._template=e}function g(n,r){x.log("setTemplate %s %s",n,r);var i="number"==typeof n?e.data[n]:n,o=x.getTemplate(i).name;x.setTemplateName(i,r),e.dispatch(t.datagrid.events.ON_ROW_TEMPLATE_CHANGE,i,o,r)}function m(){for(var t,n,r,i=e.values.activeRange.min,o=e.values.activeRange.max-i,a=!1,s={};o>i;)n=x.getTemplate(e.getData()[i]),s[n.name]||(t=e.getRowElm(i),r=t[0].offsetHeight,r!==n.height&&(n.height=r,a=!0)),i+=1;a&&e.updateHeights()}function v(){x.destroyLogger(),x=null,$.length=0,$=null}var y,$=[],b="default",x=t.logWrapper("templateModel",{},"teal",e.dispatch);return x.getTemplate=function(t){return x.getTemplateByName(t._template)},x.defaultName=b,x.createTemplates=r,x.getTemplates=a,x.getTemplateName=s,x.getTemplateByName=l,x.templateCount=h,x.dynamicHeights=u,x.averageTemplateHeight=c,x.getHeight=f,x.getTemplateHeight=p,x.setTemplate=g,x.setTemplateName=d,x.updateTemplateHeights=m,x.destroy=v,x}(),e.templateModel},t.datagrid.coreAddons.push(t.datagrid.coreAddons.templateModel)}(this.ux=this.ux||{},function(){return this}()),function(t,e,n){function r(t,n){this.wrapper="string"==typeof t?e.querySelector(t):t,this.scroller=this.wrapper.children[0],this.scrollerStyle=this.scroller.style,this.options={resizeScrollbars:!0,mouseWheelSpeed:20,snapThreshold:.334,startX:0,startY:0,scrollY:!0,directionLockThreshold:5,momentum:!0,bounce:!0,bounceTime:600,bounceEasing:"",preventDefault:!0,preventDefaultException:{tagName:/^(INPUT|TEXTAREA|BUTTON|SELECT)$/},HWCompositing:!0,useTransition:!0,useTransform:!0};for(var r in n)this.options[r]=n[r];this.translateZ=this.options.HWCompositing&&s.hasPerspective?" translateZ(0)":"",this.options.useTransition=s.hasTransition&&this.options.useTransition,this.options.useTransform=s.hasTransform&&this.options.useTransform,this.options.eventPassthrough=this.options.eventPassthrough===!0?"vertical":this.options.eventPassthrough,this.options.preventDefault=!this.options.eventPassthrough&&this.options.preventDefault,this.options.scrollY="vertical"==this.options.eventPassthrough?!1:this.options.scrollY,this.options.scrollX="horizontal"==this.options.eventPassthrough?!1:this.options.scrollX,this.options.freeScroll=this.options.freeScroll&&!this.options.eventPassthrough,this.options.directionLockThreshold=this.options.eventPassthrough?0:this.options.directionLockThreshold,this.options.bounceEasing="string"==typeof this.options.bounceEasing?s.ease[this.options.bounceEasing]||s.ease.circular:this.options.bounceEasing,this.options.resizePolling=void 0===this.options.resizePolling?60:this.options.resizePolling,this.options.tap===!0&&(this.options.tap="tap"),"scale"==this.options.shrinkScrollbars&&(this.options.useTransition=!1),this.options.invertWheelDirection=this.options.invertWheelDirection?-1:1,this.x=0,this.y=0,this.directionX=0,this.directionY=0,this._events={},this._init(),this.refresh(),this.scrollTo(this.options.startX,this.options.startY),this.enable()}function i(t,n,r){var i=e.createElement("div"),o=e.createElement("div");return r===!0&&(i.style.cssText="position:absolute;z-index:9999",o.style.cssText="-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;position:absolute;background:rgba(0,0,0,0.5);border:1px solid rgba(255,255,255,0.9);border-radius:3px"),o.className="iScrollIndicator","h"==t?(r===!0&&(i.style.cssText+=";height:7px;left:2px;right:2px;bottom:0",o.style.height="100%"),i.className="iScrollHorizontalScrollbar"):(r===!0&&(i.style.cssText+=";width:7px;bottom:2px;top:2px;right:1px",o.style.width="100%"),i.className="iScrollVerticalScrollbar"),i.style.cssText+=";overflow:hidden",n||(i.style.pointerEvents="none"),i.appendChild(o),i}function o(n,r){this.wrapper="string"==typeof r.el?e.querySelector(r.el):r.el,this.wrapperStyle=this.wrapper.style,this.indicator=this.wrapper.children[0],this.indicatorStyle=this.indicator.style,this.scroller=n,this.options={listenX:!0,listenY:!0,interactive:!1,resize:!0,defaultScrollbars:!1,shrink:!1,fade:!1,speedRatioX:0,speedRatioY:0};for(var i in r)this.options[i]=r[i];this.sizeRatioX=1,this.sizeRatioY=1,this.maxPosX=0,this.maxPosY=0,this.options.interactive&&(this.options.disableTouch||(s.addEvent(this.indicator,"touchstart",this),s.addEvent(t,"touchend",this)),this.options.disablePointer||(s.addEvent(this.indicator,"MSPointerDown",this),s.addEvent(t,"MSPointerUp",this)),this.options.disableMouse||(s.addEvent(this.indicator,"mousedown",this),s.addEvent(t,"mouseup",this))),this.options.fade&&(this.wrapperStyle[s.style.transform]=this.scroller.translateZ,this.wrapperStyle[s.style.transitionDuration]=s.isBadAndroid?"0.001s":"0ms",this.wrapperStyle.opacity="0")}var a=t.requestAnimationFrame||t.webkitRequestAnimationFrame||t.mozRequestAnimationFrame||t.oRequestAnimationFrame||t.msRequestAnimationFrame||function(e){t.setTimeout(e,1e3/60)},s=function(){function r(t){return a===!1?!1:""===a?t:a+t.charAt(0).toUpperCase()+t.substr(1)}var i={},o=e.createElement("div").style,a=function(){for(var t,e=["t","webkitT","MozT","msT","OT"],n=0,r=e.length;r>n;n++)if(t=e[n]+"ransform",t in o)return e[n].substr(0,e[n].length-1);return!1}();i.getTime=Date.now||function(){return(new Date).getTime()},i.extend=function(t,e){for(var n in e)t[n]=e[n]},i.addEvent=function(t,e,n,r){t.addEventListener(e,n,!!r)},i.removeEvent=function(t,e,n,r){t.removeEventListener(e,n,!!r)},i.momentum=function(t,e,r,i,o,a){var s,l,u=t-e,c=n.abs(u)/r;return a=void 0===a?6e-4:a,s=t+c*c/(2*a)*(0>u?-1:1),l=c/a,i>s?(s=o?i-o/2.5*(c/8):i,u=n.abs(s-t),l=u/c):s>0&&(s=o?o/2.5*(c/8):0,u=n.abs(t)+s,l=u/c),{destination:n.round(s),duration:l}};var s=r("transform");return i.extend(i,{hasTransform:s!==!1,hasPerspective:r("perspective")in o,hasTouch:"ontouchstart"in t,hasPointer:navigator.msPointerEnabled,hasTransition:r("transition")in o}),i.isBadAndroid=/Android /.test(t.navigator.appVersion)&&!/Chrome\/\d/.test(t.navigator.appVersion),i.extend(i.style={},{transform:s,transitionTimingFunction:r("transitionTimingFunction"),transitionDuration:r("transitionDuration"),transitionDelay:r("transitionDelay"),transformOrigin:r("transformOrigin")}),i.hasClass=function(t,e){var n=RegExp("(^|\\s)"+e+"(\\s|$)");return n.test(t.className)},i.addClass=function(t,e){if(!i.hasClass(t,e)){var n=t.className.split(" ");n.push(e),t.className=n.join(" ")}},i.removeClass=function(t,e){if(i.hasClass(t,e)){var n=RegExp("(^|\\s)"+e+"(\\s|$)","g");t.className=t.className.replace(n," ")}},i.offset=function(t){for(var e=-t.offsetLeft,n=-t.offsetTop;t=t.offsetParent;)e-=t.offsetLeft,n-=t.offsetTop;return{left:e,top:n}},i.preventDefaultException=function(t,e){for(var n in e)if(e[n].test(t[n]))return!0;return!1},i.extend(i.eventType={},{touchstart:1,touchmove:1,touchend:1,mousedown:2,mousemove:2,mouseup:2,MSPointerDown:3,MSPointerMove:3,MSPointerUp:3}),i.extend(i.ease={},{quadratic:{style:"cubic-bezier(0.25, 0.46, 0.45, 0.94)",fn:function(t){return t*(2-t)}},circular:{style:"cubic-bezier(0.1, 0.57, 0.1, 1)",fn:function(t){return n.sqrt(1- --t*t)}},back:{style:"cubic-bezier(0.175, 0.885, 0.32, 1.275)",fn:function(t){var e=4;return(t-=1)*t*((e+1)*t+e)+1}},bounce:{style:"",fn:function(t){return 1/2.75>(t/=1)?7.5625*t*t:2/2.75>t?7.5625*(t-=1.5/2.75)*t+.75:2.5/2.75>t?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375}},elastic:{style:"",fn:function(t){var e=.22,r=.4;return 0===t?0:1==t?1:r*n.pow(2,-10*t)*n.sin((t-e/4)*2*n.PI/e)+1}}}),i.tap=function(t,n){var r=e.createEvent("Event");r.initEvent(n,!0,!0),r.pageX=t.pageX,r.pageY=t.pageY,t.target.dispatchEvent(r)},i.click=function(t){var n,r=t.target;/(SELECT|INPUT|TEXTAREA)/i.test(r.tagName)||(n=e.createEvent("MouseEvents"),n.initMouseEvent("click",!0,!0,t.view,1,r.screenX,r.screenY,r.clientX,r.clientY,t.ctrlKey,t.altKey,t.shiftKey,t.metaKey,0,null),n._constructed=!0,r.dispatchEvent(n))},i}();r.prototype={version:"5.1.1",_init:function(){this._initEvents(),(this.options.scrollbars||this.options.indicators)&&this._initIndicators(),this.options.mouseWheel&&this._initWheel(),this.options.snap&&this._initSnap(),this.options.keyBindings&&this._initKeys()},destroy:function(){this._initEvents(!0),this._execEvent("destroy")},_transitionEnd:function(t){t.target==this.scroller&&this.isInTransition&&(this._transitionTime(),this.resetPosition(this.options.bounceTime)||(this.isInTransition=!1,this._execEvent("scrollEnd")))},_start:function(t){if(!(1!=s.eventType[t.type]&&0!==t.button||!this.enabled||this.initiated&&s.eventType[t.type]!==this.initiated)){!this.options.preventDefault||s.isBadAndroid||s.preventDefaultException(t.target,this.options.preventDefaultException)||t.preventDefault();var e,r=t.touches?t.touches[0]:t;this.initiated=s.eventType[t.type],this.moved=!1,this.distX=0,this.distY=0,this.directionX=0,this.directionY=0,this.directionLocked=0,this._transitionTime(),this.startTime=s.getTime(),this.options.useTransition&&this.isInTransition?(this.isInTransition=!1,e=this.getComputedPosition(),this._translate(n.round(e.x),n.round(e.y)),this._execEvent("scrollEnd")):!this.options.useTransition&&this.isAnimating&&(this.isAnimating=!1,this._execEvent("scrollEnd")),this.startX=this.x,this.startY=this.y,this.absStartX=this.x,this.absStartY=this.y,this.pointX=r.pageX,this.pointY=r.pageY,this._execEvent("beforeScrollStart")}},_move:function(t){if(this.enabled&&s.eventType[t.type]===this.initiated){this.options.preventDefault&&t.preventDefault();var e,r,i,o,a=t.touches?t.touches[0]:t,l=a.pageX-this.pointX,u=a.pageY-this.pointY,c=s.getTime();if(this.pointX=a.pageX,this.pointY=a.pageY,this.distX+=l,this.distY+=u,i=n.abs(this.distX),o=n.abs(this.distY),!(c-this.endTime>300&&10>i&&10>o)){if(this.directionLocked||this.options.freeScroll||(this.directionLocked=i>o+this.options.directionLockThreshold?"h":o>=i+this.options.directionLockThreshold?"v":"n"),"h"==this.directionLocked){if("vertical"==this.options.eventPassthrough)t.preventDefault();else if("horizontal"==this.options.eventPassthrough)return this.initiated=!1,void 0;u=0}else if("v"==this.directionLocked){if("horizontal"==this.options.eventPassthrough)t.preventDefault();else if("vertical"==this.options.eventPassthrough)return this.initiated=!1,void 0;l=0}l=this.hasHorizontalScroll?l:0,e=this.x+l,r=this.y+u,(e>0||this.maxScrollX>e)&&(e=this.options.bounce?this.x+l/3:e>0?0:this.maxScrollX),(r>0||this.maxScrollY>r)&&(r=this.options.bounce?this.y+u/3:r>0?0:this.maxScrollY),this.directionX=l>0?-1:0>l?1:0,this.directionY=u>0?-1:0>u?1:0,this.moved||this._execEvent("scrollStart"),this.moved=!0,this._translate(e,r),c-this.startTime>300&&(this.startTime=c,this.startX=this.x,this.startY=this.y)}}},_end:function(t){if(this.enabled&&s.eventType[t.type]===this.initiated){this.options.preventDefault&&!s.preventDefaultException(t.target,this.options.preventDefaultException)&&t.preventDefault();var e,r,i=(t.changedTouches?t.changedTouches[0]:t,s.getTime()-this.startTime),o=n.round(this.x),a=n.round(this.y),l=n.abs(o-this.startX),u=n.abs(a-this.startY),c=0,h="";if(this.isInTransition=0,this.initiated=0,this.endTime=s.getTime(),!this.resetPosition(this.options.bounceTime)){if(this.scrollTo(o,a),!this.moved)return this.options.tap&&s.tap(t,this.options.tap),this.options.click&&s.click(t),this._execEvent("scrollCancel"),void 0;if(this._events.flick&&200>i&&100>l&&100>u)return this._execEvent("flick"),void 0;if(this.options.momentum&&300>i&&(e=this.hasHorizontalScroll?s.momentum(this.x,this.startX,i,this.maxScrollX,this.options.bounce?this.wrapperWidth:0,this.options.deceleration):{destination:o,duration:0},r=this.hasVerticalScroll?s.momentum(this.y,this.startY,i,this.maxScrollY,this.options.bounce?this.wrapperHeight:0,this.options.deceleration):{destination:a,duration:0},o=e.destination,a=r.destination,c=n.max(e.duration,r.duration),this.isInTransition=1),this.options.snap){var p=this._nearestSnap(o,a);this.currentPage=p,c=this.options.snapSpeed||n.max(n.max(n.min(n.abs(o-p.x),1e3),n.min(n.abs(a-p.y),1e3)),300),o=p.x,a=p.y,this.directionX=0,this.directionY=0,h=this.options.bounceEasing}return o!=this.x||a!=this.y?((o>0||this.maxScrollX>o||a>0||this.maxScrollY>a)&&(h=s.ease.quadratic),this.scrollTo(o,a,c,h),void 0):(this._execEvent("scrollEnd"),void 0)}}},_resize:function(){var t=this;clearTimeout(this.resizeTimeout),this.resizeTimeout=setTimeout(function(){t.refresh()},this.options.resizePolling)},resetPosition:function(t){var e=this.x,n=this.y;return t=t||0,!this.hasHorizontalScroll||this.x>0?e=0:this.x<this.maxScrollX&&(e=this.maxScrollX),!this.hasVerticalScroll||this.y>0?n=0:this.y<this.maxScrollY&&(n=this.maxScrollY),e==this.x&&n==this.y?!1:(this.scrollTo(e,n,t,this.options.bounceEasing),!0)},disable:function(){this.enabled=!1},enable:function(){this.enabled=!0},refresh:function(){this.wrapper.offsetHeight,this.wrapperWidth=this.wrapper.clientWidth,this.wrapperHeight=this.wrapper.clientHeight,this.scrollerWidth=this.scroller.offsetWidth,this.scrollerHeight=this.scroller.offsetHeight,this.maxScrollX=this.wrapperWidth-this.scrollerWidth,this.maxScrollY=this.wrapperHeight-this.scrollerHeight,this.hasHorizontalScroll=this.options.scrollX&&0>this.maxScrollX,this.hasVerticalScroll=this.options.scrollY&&0>this.maxScrollY,this.hasHorizontalScroll||(this.maxScrollX=0,this.scrollerWidth=this.wrapperWidth),this.hasVerticalScroll||(this.maxScrollY=0,this.scrollerHeight=this.wrapperHeight),this.endTime=0,this.directionX=0,this.directionY=0,this.wrapperOffset=s.offset(this.wrapper),this._execEvent("refresh"),this.resetPosition()},on:function(t,e){this._events[t]||(this._events[t]=[]),this._events[t].push(e)},off:function(t,e){if(this._events[t]){var n=this._events[t].indexOf(e);n>-1&&this._events[t].splice(n,1)}},_execEvent:function(t){if(this._events[t]){var e=0,n=this._events[t].length;if(n)for(;n>e;e++)this._events[t][e].apply(this,[].slice.call(arguments,1))}},scrollBy:function(t,e,n,r){t=this.x+t,e=this.y+e,n=n||0,this.scrollTo(t,e,n,r)},scrollTo:function(t,e,n,r){r=r||s.ease.circular,this.isInTransition=this.options.useTransition&&n>0,!n||this.options.useTransition&&r.style?(this._transitionTimingFunction(r.style),this._transitionTime(n),this._translate(t,e)):this._animate(t,e,n,r.fn)},scrollToElement:function(t,e,r,i,o){if(t=t.nodeType?t:this.scroller.querySelector(t)){var a=s.offset(t);a.left-=this.wrapperOffset.left,a.top-=this.wrapperOffset.top,r===!0&&(r=n.round(t.offsetWidth/2-this.wrapper.offsetWidth/2)),i===!0&&(i=n.round(t.offsetHeight/2-this.wrapper.offsetHeight/2)),a.left-=r||0,a.top-=i||0,a.left=a.left>0?0:a.left<this.maxScrollX?this.maxScrollX:a.left,a.top=a.top>0?0:a.top<this.maxScrollY?this.maxScrollY:a.top,e=void 0===e||null===e||"auto"===e?n.max(n.abs(this.x-a.left),n.abs(this.y-a.top)):e,this.scrollTo(a.left,a.top,e,o)}},_transitionTime:function(t){if(t=t||0,this.scrollerStyle[s.style.transitionDuration]=t+"ms",!t&&s.isBadAndroid&&(this.scrollerStyle[s.style.transitionDuration]="0.001s"),this.indicators)for(var e=this.indicators.length;e--;)this.indicators[e].transitionTime(t)},_transitionTimingFunction:function(t){if(this.scrollerStyle[s.style.transitionTimingFunction]=t,this.indicators)for(var e=this.indicators.length;e--;)this.indicators[e].transitionTimingFunction(t)},_translate:function(t,e){if(this.options.useTransform?this.scrollerStyle[s.style.transform]="translate("+t+"px,"+e+"px)"+this.translateZ:(t=n.round(t),e=n.round(e),this.scrollerStyle.left=t+"px",this.scrollerStyle.top=e+"px"),this.x=t,this.y=e,this.indicators)for(var r=this.indicators.length;r--;)this.indicators[r].updatePosition()},_initEvents:function(e){var n=e?s.removeEvent:s.addEvent,r=this.options.bindToWrapper?this.wrapper:t;n(t,"orientationchange",this),n(t,"resize",this),this.options.click&&n(this.wrapper,"click",this,!0),this.options.disableMouse||(n(this.wrapper,"mousedown",this),n(r,"mousemove",this),n(r,"mousecancel",this),n(r,"mouseup",this)),s.hasPointer&&!this.options.disablePointer&&(n(this.wrapper,"MSPointerDown",this),n(r,"MSPointerMove",this),n(r,"MSPointerCancel",this),n(r,"MSPointerUp",this)),s.hasTouch&&!this.options.disableTouch&&(n(this.wrapper,"touchstart",this),n(r,"touchmove",this),n(r,"touchcancel",this),n(r,"touchend",this)),n(this.scroller,"transitionend",this),n(this.scroller,"webkitTransitionEnd",this),n(this.scroller,"oTransitionEnd",this),n(this.scroller,"MSTransitionEnd",this)},getComputedPosition:function(){var e,n,r=t.getComputedStyle(this.scroller,null);return this.options.useTransform?(r=r[s.style.transform].split(")")[0].split(", "),e=+(r[12]||r[4]),n=+(r[13]||r[5])):(e=+r.left.replace(/[^-\d.]/g,""),n=+r.top.replace(/[^-\d.]/g,"")),{x:e,y:n}},_initIndicators:function(){function t(t){for(var e=s.indicators.length;e--;)t.call(s.indicators[e])}var e,n=this.options.interactiveScrollbars,r="string"!=typeof this.options.scrollbars,a=[],s=this;this.indicators=[],this.options.scrollbars&&(this.options.scrollY&&(e={el:i("v",n,this.options.scrollbars),interactive:n,defaultScrollbars:!0,customStyle:r,resize:this.options.resizeScrollbars,shrink:this.options.shrinkScrollbars,fade:this.options.fadeScrollbars,listenX:!1},this.wrapper.appendChild(e.el),a.push(e)),this.options.scrollX&&(e={el:i("h",n,this.options.scrollbars),interactive:n,defaultScrollbars:!0,customStyle:r,resize:this.options.resizeScrollbars,shrink:this.options.shrinkScrollbars,fade:this.options.fadeScrollbars,listenY:!1},this.wrapper.appendChild(e.el),a.push(e))),this.options.indicators&&(a=a.concat(this.options.indicators));for(var l=a.length;l--;)this.indicators.push(new o(this,a[l]));this.options.fadeScrollbars&&(this.on("scrollEnd",function(){t(function(){this.fade()})}),this.on("scrollCancel",function(){t(function(){this.fade()})}),this.on("scrollStart",function(){t(function(){this.fade(1)})}),this.on("beforeScrollStart",function(){t(function(){this.fade(1,!0)})})),this.on("refresh",function(){t(function(){this.refresh()})}),this.on("destroy",function(){t(function(){this.destroy()}),delete this.indicators})},_initWheel:function(){s.addEvent(this.wrapper,"wheel",this),s.addEvent(this.wrapper,"mousewheel",this),s.addEvent(this.wrapper,"DOMMouseScroll",this),this.on("destroy",function(){s.removeEvent(this.wrapper,"wheel",this),s.removeEvent(this.wrapper,"mousewheel",this),s.removeEvent(this.wrapper,"DOMMouseScroll",this)})},_wheel:function(t){if(this.enabled){t.preventDefault(),t.stopPropagation();var e,r,i,o,a=this;if(void 0===this.wheelTimeout&&a._execEvent("scrollStart"),clearTimeout(this.wheelTimeout),this.wheelTimeout=setTimeout(function(){a._execEvent("scrollEnd"),a.wheelTimeout=void 0},400),"deltaX"in t)e=-t.deltaX,r=-t.deltaY;else if("wheelDeltaX"in t)e=t.wheelDeltaX/120*this.options.mouseWheelSpeed,r=t.wheelDeltaY/120*this.options.mouseWheelSpeed;else if("wheelDelta"in t)e=r=t.wheelDelta/120*this.options.mouseWheelSpeed;else{if(!("detail"in t))return;e=r=-t.detail/3*this.options.mouseWheelSpeed}if(e*=this.options.invertWheelDirection,r*=this.options.invertWheelDirection,this.hasVerticalScroll||(e=r,r=0),this.options.snap)return i=this.currentPage.pageX,o=this.currentPage.pageY,e>0?i--:0>e&&i++,r>0?o--:0>r&&o++,this.goToPage(i,o),void 0;i=this.x+n.round(this.hasHorizontalScroll?e:0),o=this.y+n.round(this.hasVerticalScroll?r:0),i>0?i=0:this.maxScrollX>i&&(i=this.maxScrollX),o>0?o=0:this.maxScrollY>o&&(o=this.maxScrollY),this.scrollTo(i,o,0)}},_initSnap:function(){this.currentPage={},"string"==typeof this.options.snap&&(this.options.snap=this.scroller.querySelectorAll(this.options.snap)),this.on("refresh",function(){var t,e,r,i,o,a,s=0,l=0,u=0,c=this.options.snapStepX||this.wrapperWidth,h=this.options.snapStepY||this.wrapperHeight;if(this.pages=[],this.wrapperWidth&&this.wrapperHeight&&this.scrollerWidth&&this.scrollerHeight){if(this.options.snap===!0)for(r=n.round(c/2),i=n.round(h/2);u>-this.scrollerWidth;){for(this.pages[s]=[],t=0,o=0;o>-this.scrollerHeight;)this.pages[s][t]={x:n.max(u,this.maxScrollX),y:n.max(o,this.maxScrollY),width:c,height:h,cx:u-r,cy:o-i},o-=h,t++;u-=c,s++}else for(a=this.options.snap,t=a.length,e=-1;t>s;s++)(0===s||a[s].offsetLeft<=a[s-1].offsetLeft)&&(l=0,e++),this.pages[l]||(this.pages[l]=[]),u=n.max(-a[s].offsetLeft,this.maxScrollX),o=n.max(-a[s].offsetTop,this.maxScrollY),r=u-n.round(a[s].offsetWidth/2),i=o-n.round(a[s].offsetHeight/2),this.pages[l][e]={x:u,y:o,width:a[s].offsetWidth,height:a[s].offsetHeight,cx:r,cy:i},u>this.maxScrollX&&l++;
this.goToPage(this.currentPage.pageX||0,this.currentPage.pageY||0,0),0===this.options.snapThreshold%1?(this.snapThresholdX=this.options.snapThreshold,this.snapThresholdY=this.options.snapThreshold):(this.snapThresholdX=n.round(this.pages[this.currentPage.pageX][this.currentPage.pageY].width*this.options.snapThreshold),this.snapThresholdY=n.round(this.pages[this.currentPage.pageX][this.currentPage.pageY].height*this.options.snapThreshold))}}),this.on("flick",function(){var t=this.options.snapSpeed||n.max(n.max(n.min(n.abs(this.x-this.startX),1e3),n.min(n.abs(this.y-this.startY),1e3)),300);this.goToPage(this.currentPage.pageX+this.directionX,this.currentPage.pageY+this.directionY,t)})},_nearestSnap:function(t,e){if(!this.pages.length)return{x:0,y:0,pageX:0,pageY:0};var r=0,i=this.pages.length,o=0;if(n.abs(t-this.absStartX)<this.snapThresholdX&&n.abs(e-this.absStartY)<this.snapThresholdY)return this.currentPage;for(t>0?t=0:this.maxScrollX>t&&(t=this.maxScrollX),e>0?e=0:this.maxScrollY>e&&(e=this.maxScrollY);i>r;r++)if(t>=this.pages[r][0].cx){t=this.pages[r][0].x;break}for(i=this.pages[r].length;i>o;o++)if(e>=this.pages[0][o].cy){e=this.pages[0][o].y;break}return r==this.currentPage.pageX&&(r+=this.directionX,0>r?r=0:r>=this.pages.length&&(r=this.pages.length-1),t=this.pages[r][0].x),o==this.currentPage.pageY&&(o+=this.directionY,0>o?o=0:o>=this.pages[0].length&&(o=this.pages[0].length-1),e=this.pages[0][o].y),{x:t,y:e,pageX:r,pageY:o}},goToPage:function(t,e,r,i){i=i||this.options.bounceEasing,t>=this.pages.length?t=this.pages.length-1:0>t&&(t=0),e>=this.pages[t].length?e=this.pages[t].length-1:0>e&&(e=0);var o=this.pages[t][e].x,a=this.pages[t][e].y;r=void 0===r?this.options.snapSpeed||n.max(n.max(n.min(n.abs(o-this.x),1e3),n.min(n.abs(a-this.y),1e3)),300):r,this.currentPage={x:o,y:a,pageX:t,pageY:e},this.scrollTo(o,a,r,i)},next:function(t,e){var n=this.currentPage.pageX,r=this.currentPage.pageY;n++,n>=this.pages.length&&this.hasVerticalScroll&&(n=0,r++),this.goToPage(n,r,t,e)},prev:function(t,e){var n=this.currentPage.pageX,r=this.currentPage.pageY;n--,0>n&&this.hasVerticalScroll&&(n=0,r--),this.goToPage(n,r,t,e)},_initKeys:function(){var e,n={pageUp:33,pageDown:34,end:35,home:36,left:37,up:38,right:39,down:40};if("object"==typeof this.options.keyBindings)for(e in this.options.keyBindings)"string"==typeof this.options.keyBindings[e]&&(this.options.keyBindings[e]=this.options.keyBindings[e].toUpperCase().charCodeAt(0));else this.options.keyBindings={};for(e in n)this.options.keyBindings[e]=this.options.keyBindings[e]||n[e];s.addEvent(t,"keydown",this),this.on("destroy",function(){s.removeEvent(t,"keydown",this)})},_key:function(t){if(this.enabled){var e,r=this.options.snap,i=r?this.currentPage.pageX:this.x,o=r?this.currentPage.pageY:this.y,a=s.getTime(),l=this.keyTime||0,u=.25;switch(this.options.useTransition&&this.isInTransition&&(e=this.getComputedPosition(),this._translate(n.round(e.x),n.round(e.y)),this.isInTransition=!1),this.keyAcceleration=200>a-l?n.min(this.keyAcceleration+u,50):0,t.keyCode){case this.options.keyBindings.pageUp:this.hasHorizontalScroll&&!this.hasVerticalScroll?i+=r?1:this.wrapperWidth:o+=r?1:this.wrapperHeight;break;case this.options.keyBindings.pageDown:this.hasHorizontalScroll&&!this.hasVerticalScroll?i-=r?1:this.wrapperWidth:o-=r?1:this.wrapperHeight;break;case this.options.keyBindings.end:i=r?this.pages.length-1:this.maxScrollX,o=r?this.pages[0].length-1:this.maxScrollY;break;case this.options.keyBindings.home:i=0,o=0;break;case this.options.keyBindings.left:i+=r?-1:5+this.keyAcceleration>>0;break;case this.options.keyBindings.up:o+=r?1:5+this.keyAcceleration>>0;break;case this.options.keyBindings.right:i-=r?-1:5+this.keyAcceleration>>0;break;case this.options.keyBindings.down:o-=r?1:5+this.keyAcceleration>>0;break;default:return}if(r)return this.goToPage(i,o),void 0;i>0?(i=0,this.keyAcceleration=0):this.maxScrollX>i&&(i=this.maxScrollX,this.keyAcceleration=0),o>0?(o=0,this.keyAcceleration=0):this.maxScrollY>o&&(o=this.maxScrollY,this.keyAcceleration=0),this.scrollTo(i,o,0),this.keyTime=a}},_animate:function(t,e,n,r){function i(){var p,f,d,g=s.getTime();return g>=h?(o.isAnimating=!1,o._translate(t,e),o.resetPosition(o.options.bounceTime)||o._execEvent("scrollEnd"),void 0):(g=(g-c)/n,d=r(g),p=(t-l)*d+l,f=(e-u)*d+u,o._translate(p,f),o.isAnimating&&a(i),void 0)}var o=this,l=this.x,u=this.y,c=s.getTime(),h=c+n;this.isAnimating=!0,i()},handleEvent:function(t){switch(t.type){case"touchstart":case"MSPointerDown":case"mousedown":this._start(t);break;case"touchmove":case"MSPointerMove":case"mousemove":this._move(t);break;case"touchend":case"MSPointerUp":case"mouseup":case"touchcancel":case"MSPointerCancel":case"mousecancel":this._end(t);break;case"orientationchange":case"resize":this._resize();break;case"transitionend":case"webkitTransitionEnd":case"oTransitionEnd":case"MSTransitionEnd":this._transitionEnd(t);break;case"wheel":case"DOMMouseScroll":case"mousewheel":this._wheel(t);break;case"keydown":this._key(t);break;case"click":t._constructed||(t.preventDefault(),t.stopPropagation())}}},o.prototype={handleEvent:function(t){switch(t.type){case"touchstart":case"MSPointerDown":case"mousedown":this._start(t);break;case"touchmove":case"MSPointerMove":case"mousemove":this._move(t);break;case"touchend":case"MSPointerUp":case"mouseup":case"touchcancel":case"MSPointerCancel":case"mousecancel":this._end(t)}},destroy:function(){this.options.interactive&&(s.removeEvent(this.indicator,"touchstart",this),s.removeEvent(this.indicator,"MSPointerDown",this),s.removeEvent(this.indicator,"mousedown",this),s.removeEvent(t,"touchmove",this),s.removeEvent(t,"MSPointerMove",this),s.removeEvent(t,"mousemove",this),s.removeEvent(t,"touchend",this),s.removeEvent(t,"MSPointerUp",this),s.removeEvent(t,"mouseup",this)),this.options.defaultScrollbars&&this.wrapper.parentNode.removeChild(this.wrapper)},_start:function(e){var n=e.touches?e.touches[0]:e;e.preventDefault(),e.stopPropagation(),this.transitionTime(),this.initiated=!0,this.moved=!1,this.lastPointX=n.pageX,this.lastPointY=n.pageY,this.startTime=s.getTime(),this.options.disableTouch||s.addEvent(t,"touchmove",this),this.options.disablePointer||s.addEvent(t,"MSPointerMove",this),this.options.disableMouse||s.addEvent(t,"mousemove",this),this.scroller._execEvent("beforeScrollStart")},_move:function(t){var e,n,r,i,o=t.touches?t.touches[0]:t;s.getTime(),this.moved||this.scroller._execEvent("scrollStart"),this.moved=!0,e=o.pageX-this.lastPointX,this.lastPointX=o.pageX,n=o.pageY-this.lastPointY,this.lastPointY=o.pageY,r=this.x+e,i=this.y+n,this._pos(r,i),t.preventDefault(),t.stopPropagation()},_end:function(e){if(this.initiated){if(this.initiated=!1,e.preventDefault(),e.stopPropagation(),s.removeEvent(t,"touchmove",this),s.removeEvent(t,"MSPointerMove",this),s.removeEvent(t,"mousemove",this),this.scroller.options.snap){var r=this.scroller._nearestSnap(this.scroller.x,this.scroller.y),i=this.options.snapSpeed||n.max(n.max(n.min(n.abs(this.scroller.x-r.x),1e3),n.min(n.abs(this.scroller.y-r.y),1e3)),300);(this.scroller.x!=r.x||this.scroller.y!=r.y)&&(this.scroller.directionX=0,this.scroller.directionY=0,this.scroller.currentPage=r,this.scroller.scrollTo(r.x,r.y,i,this.scroller.options.bounceEasing))}this.moved&&this.scroller._execEvent("scrollEnd")}},transitionTime:function(t){t=t||0,this.indicatorStyle[s.style.transitionDuration]=t+"ms",!t&&s.isBadAndroid&&(this.indicatorStyle[s.style.transitionDuration]="0.001s")},transitionTimingFunction:function(t){this.indicatorStyle[s.style.transitionTimingFunction]=t},refresh:function(){this.transitionTime(),this.indicatorStyle.display=this.options.listenX&&!this.options.listenY?this.scroller.hasHorizontalScroll?"block":"none":this.options.listenY&&!this.options.listenX?this.scroller.hasVerticalScroll?"block":"none":this.scroller.hasHorizontalScroll||this.scroller.hasVerticalScroll?"block":"none",this.scroller.hasHorizontalScroll&&this.scroller.hasVerticalScroll?(s.addClass(this.wrapper,"iScrollBothScrollbars"),s.removeClass(this.wrapper,"iScrollLoneScrollbar"),this.options.defaultScrollbars&&this.options.customStyle&&(this.options.listenX?this.wrapper.style.right="8px":this.wrapper.style.bottom="8px")):(s.removeClass(this.wrapper,"iScrollBothScrollbars"),s.addClass(this.wrapper,"iScrollLoneScrollbar"),this.options.defaultScrollbars&&this.options.customStyle&&(this.options.listenX?this.wrapper.style.right="2px":this.wrapper.style.bottom="2px")),this.wrapper.offsetHeight,this.options.listenX&&(this.wrapperWidth=this.wrapper.clientWidth,this.options.resize?(this.indicatorWidth=n.max(n.round(this.wrapperWidth*this.wrapperWidth/(this.scroller.scrollerWidth||this.wrapperWidth||1)),8),this.indicatorStyle.width=this.indicatorWidth+"px"):this.indicatorWidth=this.indicator.clientWidth,this.maxPosX=this.wrapperWidth-this.indicatorWidth,"clip"==this.options.shrink?(this.minBoundaryX=-this.indicatorWidth+8,this.maxBoundaryX=this.wrapperWidth-8):(this.minBoundaryX=0,this.maxBoundaryX=this.maxPosX),this.sizeRatioX=this.options.speedRatioX||this.scroller.maxScrollX&&this.maxPosX/this.scroller.maxScrollX),this.options.listenY&&(this.wrapperHeight=this.wrapper.clientHeight,this.options.resize?(this.indicatorHeight=n.max(n.round(this.wrapperHeight*this.wrapperHeight/(this.scroller.scrollerHeight||this.wrapperHeight||1)),8),this.indicatorStyle.height=this.indicatorHeight+"px"):this.indicatorHeight=this.indicator.clientHeight,this.maxPosY=this.wrapperHeight-this.indicatorHeight,"clip"==this.options.shrink?(this.minBoundaryY=-this.indicatorHeight+8,this.maxBoundaryY=this.wrapperHeight-8):(this.minBoundaryY=0,this.maxBoundaryY=this.maxPosY),this.maxPosY=this.wrapperHeight-this.indicatorHeight,this.sizeRatioY=this.options.speedRatioY||this.scroller.maxScrollY&&this.maxPosY/this.scroller.maxScrollY),this.updatePosition()},updatePosition:function(){var t=this.options.listenX&&n.round(this.sizeRatioX*this.scroller.x)||0,e=this.options.listenY&&n.round(this.sizeRatioY*this.scroller.y)||0;this.options.ignoreBoundaries||(this.minBoundaryX>t?("scale"==this.options.shrink&&(this.width=n.max(this.indicatorWidth+t,8),this.indicatorStyle.width=this.width+"px"),t=this.minBoundaryX):t>this.maxBoundaryX?"scale"==this.options.shrink?(this.width=n.max(this.indicatorWidth-(t-this.maxPosX),8),this.indicatorStyle.width=this.width+"px",t=this.maxPosX+this.indicatorWidth-this.width):t=this.maxBoundaryX:"scale"==this.options.shrink&&this.width!=this.indicatorWidth&&(this.width=this.indicatorWidth,this.indicatorStyle.width=this.width+"px"),this.minBoundaryY>e?("scale"==this.options.shrink&&(this.height=n.max(this.indicatorHeight+3*e,8),this.indicatorStyle.height=this.height+"px"),e=this.minBoundaryY):e>this.maxBoundaryY?"scale"==this.options.shrink?(this.height=n.max(this.indicatorHeight-3*(e-this.maxPosY),8),this.indicatorStyle.height=this.height+"px",e=this.maxPosY+this.indicatorHeight-this.height):e=this.maxBoundaryY:"scale"==this.options.shrink&&this.height!=this.indicatorHeight&&(this.height=this.indicatorHeight,this.indicatorStyle.height=this.height+"px")),this.x=t,this.y=e,this.scroller.options.useTransform?this.indicatorStyle[s.style.transform]="translate("+t+"px,"+e+"px)"+this.scroller.translateZ:(this.indicatorStyle.left=t+"px",this.indicatorStyle.top=e+"px")},_pos:function(t,e){0>t?t=0:t>this.maxPosX&&(t=this.maxPosX),0>e?e=0:e>this.maxPosY&&(e=this.maxPosY),t=this.options.listenX?n.round(t/this.sizeRatioX):this.scroller.x,e=this.options.listenY?n.round(e/this.sizeRatioY):this.scroller.y,this.scroller.scrollTo(t,e)},fade:function(t,e){if(!e||this.visible){clearTimeout(this.fadeTimeout),this.fadeTimeout=null;var n=t?250:500,r=t?0:300;t=t?"1":"0",this.wrapperStyle[s.style.transitionDuration]=n+"ms",this.fadeTimeout=setTimeout(function(t){this.wrapperStyle.opacity=t,this.visible=+t}.bind(this,t),r)}}},r.utils=s,"undefined"!=typeof module&&module.exports?module.exports=r:t.IScroll=r}(window,document,Math),function(t){angular.module("ux").factory("iScrollAddon",function(){return function(e){function n(){var t={mouseWheel:!0,scrollbars:!0,bounce:!0,bindToWrapper:!0,tap:!0,interactiveScrollbars:!0,deceleration:.005,click:!0,startY:-(e.values.scroll||0)};p||(e.element[0].style.overflowY="hidden",p=new IScroll(e.element[0],t),p.on("beforeScrollStart",o),p.on("scrollStart",o),p.on("scrollEnd",a)),p._initEvents(!0),p.scroller=e.getContent()[0],p.scrollerStyle=p.scroller.style,p._initEvents(),p.scrollTo(0,t.startY),m.iScroll=p,r()}function r(){l(),f=setInterval(u,100)}function i(){clearTimeout(h)}function o(){i(),v=!0,e.dispatch(t.datagrid.events.ON_SCROLL_START,-p.y)}function a(){i(),h=setTimeout(s,e.options.updateDelay)}function s(){e.values.scroll=-p.y,y.onScrollingStop(),v=!1}function l(){clearInterval(f)}function u(){e.element?e.element[0].offsetHeight&&(l(),p.refresh()):l()}function c(t){var n=void 0!==t?-t:p.y;v&&n!==$&&(e.values.speed=n-$,e.values.absSpeed=Math.abs(e.values.speed),m.setScroll(-n),$=n,e.values.scrollPercent=(100*(e.values.scroll/e.getContentHeight())).toFixed(2),m.fireOnScroll())}if(t.datagrid.isIOS){if(!IScroll)throw Error("IScroll (https://github.com/cubiq/iscroll) is required to use the iScrollAddon.");var h,p,f,d,g,m=t.logWrapper("iScrollAddon",{},"purple",e.dispatch),v=!1,y=e.scrollModel,$=0;return g=e.scope.$on(t.datagrid.events.ON_READY,function(){y.removeScrollListener(),g()}),e.unwatchers.push(e.scope.$on(t.datagrid.events.ON_AFTER_HEIGHTS_UPDATED_RENDER,n)),m.getScroll=function(){return p&&p.y||0},m.setScroll=function(t){e.values.scroll=t},m.waitForStop=y.waitForStop,m.scrollTo=function(t,r){e.element[0].scrollTop&&(e.element[0].scrollTop=0),p||n(),p.scrollTo(0,-t,r?0:200),clearTimeout(d),r?(v=!0,m.onUpdateScroll(t),v=!1,m.onScrollingStop()):d=setTimeout(function(){m.onScrollingStop()},200)},m.scrollToIndex=y.scrollToIndex,m.scrollToItem=y.scrollToItem,m.scrollIntoView=y.scrollIntoView,m.scrollToBottom=function(t){var n=e.getContentHeight()-e.getViewportHeight();p.scrollTo(0,-n,t?0:200)},m.onScrollingStop=y.onScrollingStop,m.onUpdateScroll=c,m.fireOnScroll=y.fireOnScroll,e.unwatchers.push(e.scope.$on(t.datagrid.events.RESIZE,function(){e.element[0].scrollTop=0,p.refresh()})),m.destroy=function(){g(),clearTimeout(d),i(),y.destroy(),p&&p.destroy()},e.scrollModel=m,m}}})}(this.ux=this.ux||{},function(){return this}()),angular.module("app",["ngCookies","ngResource","ngSanitize","ui.router","directive.ng-extend","debounce","angular-fullscreen","angular-spinner","addon.security","addon.dashboard","addon.binding","addon.authentication"]).config(["$stateProvider","$urlRouterProvider","$locationProvider",function(t,e,n){e.otherwise("/"),n.hashPrefix("!")}]).factory("Logger",["$interval",function(){return{init:function(){var t={iStart:null,iEnd:null,iCost:null,start:function(){t.iStart=new Date,t.iEnd=null,t.iCost=null},stop:function(){t.iEnd=new Date,t.iCost=t.iEnd-t.iStart}};return t}}}]).factory("App",function(){var t={state:{fromState:{},fromParams:{},toState:{},toParams:{}},menu:{getState:function(){var e="";try{e=t.state.toState.url.split("/")[1],e="/"===t.state.toState.url?"dashboard":e}catch(n){}return e}}};return t}).run(["App","$rootScope",function(t,e){e.$on("$stateChangeSuccess",function(e,n,r,i,o){t.state={fromState:i,fromParams:o,toState:n,toParams:r}})}]).controller("AppCtrl",["App","$scope",function(){}]),angular.module("addon.authentication",["app","ui.router"]).config(["$stateProvider",function(t){t.state("authentication",{url:"/authentication",controller:"AuthenticationCtrl",templateUrl:"app/authentication/index.html"})}]).controller("AuthenticationCtrl",["App","security","$scope","$interval",function(t,e,n){e.requestUserInfo().then(function(){}),n.security=e,n.Signout=function(){e.signout("/#!/authentication")}}]),angular.module("addon.binding",["app","ui.router","ux"]).config(["$stateProvider",function(t){t.state("binding_problem",{url:"/ng-repeat-table-2500-binding",controller:"BindingProblemCtrl",templateUrl:"app/binding/problem.html"}).state("binding_solution",{url:"/ux-angularjs-datagrid-50k-binding",controller:"BindingSolutionCtrl",templateUrl:"app/binding/solution.html"}).state("binding_a_function",{url:"/binding-a-function",controller:"BindingFunctionCtrl",templateUrl:"app/binding/function.html"}).state("binding_cache",{url:"/binding-cache",controller:"BindingCacheCtrl",templateUrl:"app/binding/cache.html"})}]).controller("BindingCacheCtrl",["App","Logger","$scope","$interval",function(t,e,n){n.func=function(){var t={numOfCall:0,value:0,init:function(){return t},getValue:_.memoize(function(){return t.numOfCall+=1,t.value},function(){return t.value}),increaseValue:function(){t.value+=1}};return t.init()}()}]).controller("BindingFunctionCtrl",["App","Logger","$scope","$interval",function(t,e,n){n.func=function(){var t={numOfCall:0,value:0,init:function(){return t},getValue:function(){return t.numOfCall+=1,t.value},increaseValue:function(){t.value+=1}};return t.init()}()}]).controller("BindingSolutionCtrl",["App","Logger","$scope","$interval",function(t,e,n,r){var i=1e4;n.data=function(){var t={data:[],init:function(){for(var e=0,n=[];i>e;)n.push({id:e,firstname:"firstname "+e,lastname:"lastname "+e,gender:e%2,timestamp:""}),e+=1;return t.data=n,t}};return t.init()}(),n.loggerInit=function(){var t={init:function(){var t=e.init(),i=$("#test").html(),o=r(function(){return $("#test").html()!==i?(n.loggerInit.stop(),r.cancel(o)):void 0},100);return t.start(),t}};return t.init()}(),n.loggerEdit=function(){var t={init:function(){var t=e.init(),i=null;return t.diffLabel=null,t.changeData=function(){t.start(),t.diffLabel=null;var e=$("#test").html(),o=r(function(){return $("#test").html()!==e?(i=$("#test").html(),n.loggerEdit.stop(),r.cancel(o)):void 0},100);console.log(n.data.data),_.each(n.data.data,function(t){t.timestamp=new Date})},t.checkDiff=function(){t.diffLabel=i===$("#test").html()?"(the same)":"(different)"},t}};return t.init()}()}]).controller("BindingProblemCtrl",["App","Logger","$scope","$http","$q","$interval",function(t,e,n,r,i,o){var a=500;n.data=function(){var t={data:[],init:function(){for(var e=0,n=[];a>e;)n.push({id:e,firstname:"firstname "+e,lastname:"lastname "+e,gender:e%2,timestamp:""}),e+=1;return t.data=n,t}};return t.init()}(),n.loggerInit=function(){var t={init:function(){var t=e.init(),r=$("#test").html(),i=o(function(){return $("#test").html()!==r?(n.loggerInit.stop(),o.cancel(i)):void 0},100);return t.start(),t}};return t.init()}(),n.loggerEdit=function(){var t={init:function(){var t=e.init(),r=null;return t.diffLabel=null,t.changeData=function(){t.start(),t.diffLabel=null;var e=$("#test").html(),i=o(function(){return $("#test").html()!==e?(r=$("#test").html(),n.loggerEdit.stop(),o.cancel(i)):void 0},100);_.each(n.data.data,function(t){t.timestamp=new Date})},t.checkDiff=function(){t.diffLabel=r===$("#test").html()?"(the same)":"(different)"},t}};return t.init()}()}]),angular.module("addon.dashboard",["app","ui.router"]).config(["$stateProvider",function(t){t.state("dashboard",{url:"/",controller:"DashboardCtrl",templateUrl:"app/dashboard/index.html"})}]).controller("DashboardCtrl",["App","$scope","$http","$q",function(){}]),angular.module("addon.security.interceptor",["addon.security.retryQueue"]).factory("securityInterceptor",["$injector","securityRetryQueue",function(t,e){var n=e;return function(e){return e.then(function(t){return t},function(r){return 401===r.status&&(e=n.pushRetryFn("unauthorized-server",function(){return t.get("$http")(r.config)})),e})}}]).config(["$httpProvider",function(t){t.responseInterceptors.push("securityInterceptor")}]),angular.module("addon.security",["addon.security.signinForm","addon.security.security","addon.security.retryQueue","addon.security.interceptor"]).run(["security",function(){}]),angular.module("addon.security.retryQueue",[]).factory("securityRetryQueue",["$q",function(t){var e=[];window.retryQueue=e;var n={onItemAddedCallbacks:[],hasMore:function(){return e.length>0},push:function(t){e.push(t),angular.forEach(n.onItemAddedCallbacks,function(e){try{e(t)}catch(n){}})},pushRetryFn:function(e,r){1===arguments.length&&(r=e,e=void 0);var i=t.defer(),o={reason:e,retry:function(){t.when(r()).then(function(t){i.resolve(t)},function(t){i.reject(t)})},cancel:function(){i.reject()}};return n.push(o),i.promise},retryReason:function(){return n.hasMore()&&e[0].reason},cancelAll:function(){for(;n.hasMore();)e.shift().cancel()},retryAll:function(){for(;n.hasMore();)e.shift().retry()}};return n}]),angular.module("addon.security.security",["ui.bootstrap","addon.security.retryQueue"]).factory("security",["$http","$q","$location","$modal","securityRetryQueue",function(t,e,n,r,i){function o(t){t=t||"/",n.path()===t?window.location.href=t:(window.location.reload(!1),window.location.href=t)}function a(t){c&&(c.close(t),c=null)}function s(){c||(c=r.open({templateUrl:"/app/security/template/signinForm.tpl.html",controller:"SigninFormCtrl",backdrop:"static",keyboard:!1}),c.result.then(l))}function l(t){t?u.retryAll():(u.cancelAll(),o())}var u=i,c=null;u.onItemAddedCallbacks.push(function(){u.hasMore()&&h.showSignin()});var h={user_info:null,getSigninReason:function(){return null},showSignin:function(){s()},cancelSignin:function(){a(!1),o()},signin:function(e){var n=t.post("/api/user/authenticate/email",{email:e.email,password:e.password});return n.then(function(t){return h.user_info=null,"ok"===t.data.status?(a(!0),!0):!1})},signout:function(e){return t.post("/api/user/signout").then(function(){h.user_info=null,o(e)})},isAuthenticated:function(){return!!h.user_info},requestUserInfo:function(){return h.isAuthenticated()?e.when(h.user_info):t.get("/api/user").then(function(t){return h.user_info=null,"ok"===t.data.status&&(h.user_info=t.data.data),h.user_info})}};return h}]),angular.module("addon.security.signinForm",["addon.security.security"]).controller("SigninFormCtrl",["$scope","security",function(t,e){t.user={},t.authError=null,t.authReason=e.getSigninReason(),t.signin=function(){t.authError=null,e.signin({email:t.user.email,password:t.user.password}).then(function(e){e||(t.authError="Email and password are invalid.")},function(){t.authError="Server error. Please try again."})},t.clearForm=function(){t.user={}},t.cancelSignin=function(){}}]);